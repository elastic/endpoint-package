---
- name: malware_classification
  title: Malware Classification
  group: 2
  short: These fields contain the malware classification.
  description: >
    These fields contain the malware classification.
  reusable:
    order: 1
    top_level: false
    expected:
      - dll.Ext
      - process.Ext
      - file.Ext
  type: group
  fields:
    - name: score
      level: custom
      type: double
      description: >
        The score produced by the classification model.

    - name: threshold
      level: custom
      type: double
      description: >
        The score threshold for the model.  Files that score above this threshold are considered malicious.

    - name: identifier
      level: custom
      type: keyword
      description: >
        The model's unique identifier.

    - name: version
      level: custom
      type: keyword
      description: >
        The version of the model used.

    - name: features
      level: custom
      type: object
      object_type: keyword
      enabled: false
      description: >
        The features extracted from this file and evaluated by the model.

    - name: features.data.buffer
      level: custom
      type: keyword
      description: >
        The features extracted from this file and evaluated by the model.  Usually an array of floats.  Likely zlib-encoded.

    - name: features.data.decompressed_size
      level: custom
      type: integer
      description: >
        The decompressed size of buffer.

    - name: features.data.encoding
      level: custom
      type: keyword
      description: >
        The encoding of buffer (e.g. zlib).

    - name: upx_packed
      level: custom
      type: boolean
      description: >
        Whether UPX packing was detected.
