---
- name: virtualmemory
  title: VirtualMemory
  group: 2
  short: Fields describing Windows virtual memory API calls.
  description: >
    Fields describing VirtualAlloc[Ex], VirtualProtect[Ex] and MapViewOfFile[2] and WriteProcessMemory API calls.

  reusable:
    top_level: true
    expected:
      - { at: process.Ext.api, as: parameters }
  type: group

  fields:
    - name: address
      level: custom
      type: unsigned_long
      description: >
        The target memory address.
      example: 2431737462784

    - name: size
      level: custom
      type: unsigned_long
      description: >
        The size.
      example: 4096

    - name: protection
      level: custom
      type: keyword
      description: >
        The memory protection for the region of pages. Corresponds to `MEMORY_BASIC_INFORMATION.Protect`
      example: "RWX|GUARD"

    - name: protection_old
      level: custom
      type: keyword
      example: "RCX"
      description: >
        The previous memory protection returned by the API call. Corresponds to `MEMORY_BASIC_INFORMATION.Protect`

    - name: allocation_type
      level: custom
      type: keyword
      description: >
        The type of memory allocation. Corresponds to `MEMORY_BASIC_INFORMATION.State`
      example: "COMMIT|RESERVE"