---
- name: malware_signature
  title: Malware Signature
  group: 2
  short: These fields contain the yara malware signature.
  description: >
    These fields contain the yara malware signature.
  reusable:
    order: 1
    top_level: false
    expected:
      - memory_region
      - process.Ext
  type: group
  fields:
    - name: all_names
      level: custom
      type: keyword
      example: "Windows.EICAR.Not-a-virus"
      description: A sequence of signature names matched.

    - name: identifier
      level: custom
      type: keyword
      description: malware signature identifier

    - name: version
      level: custom
      type: keyword
      description: malware signature version

    - name: primary
      level: custom
      type: object
      description: The first matching details.

    - name: primary.matches
      level: custom
      type: keyword
      description: The first matching details.
      enabled: false

    - name: primary.signature.id
      level: custom
      type: keyword
      description: The id of the first yara rule matched.

    - name: primary.signature.name
      level: custom
      type: keyword
      description: The name of the first yara rule matched.

    - name: primary.signature.hash
      level: custom
      type: nested
      description: hash of file matching signature.

    - name: primary.signature.hash.sha256
      level: custom
      type: keyword
      description: sha256 hash of file matching signature.

    - name: secondary
      level: custom
      type: nested
      enabled: false
      description: Additional matching details if available.
