---
- name: malware_signature
  title: Malware Signature
  group: 2
  short: These fields contain the yara malware signature.
  description: >
    These fields contain the yara malware signature.
  reusable:
    order: 1
    top_level: false
    expected:
      - process.Ext
      - file.Ext
  type: group
  fields:
    - name: all_names
      level: custom
      type: keyword
      example: "Windows.EICAR.Not-a-virus"
      description: A sequence of signature names matched.

    - name: primary
      level: custom
      type: object
      description: The first matching details.

    - name: primary.signature.id
      level: custom
      type: keyword
      description: The id of the first yara rule matched.

    - name: primary.signature.name
      level: custom
      type: keyword
      description: The name of the first yara rule matched.

    - name: malware_signature.memory_region.allocation_protection
      level: custom
      type: keyword
      example: "RWX"
      description: >
        Original memory protection requested when the memory was allocated. Example values include "RWX" and "R-X".

    - name: malware_signature.memory_region.allocation_size
      level: custom
      type: long
      description: >
        Original memory size requested when the memory was allocated.

    - name: malware_signature.memory_region.allocation_type
      level: custom
      type: keyword
      description: >
        The memory allocation type. Example values include "IMAGE", "MAPPED", and "PRIVATE".

    - name: malware_signature.memory_region.region_protection
      level: custom
      type: keyword
      description: >
        Memory protection of the memory region. Example values include "RWX" and "R-X".

    - name: malware_signature.memory_region.region_size
      level: custom
      type: long
      description: >
        Size of the memory region.

    - name: malware_signature.memory_region.region_state
      level: custom
      type: keyword
      description: >
        State of the memory region. Example values include "RESERVE", "COMMIT", and "FREE".

    - name: malware_signature.memory_region.memory_pe.imphash
      level: custom
      type: keyword
      description: 'A hash of the imports in a PE file. An imphash -- or import hash --
        can be used to fingerprint binaries even after recompilation or other code-level
        transformations have occurred, which would change more traditional hash values.

        Learn more at https://www.fireeye.com/blog/threat-research/2014/01/tracking-malware-import-hashing.html.'

    - name: malware_signature.memory_region.bytes_allocation_offset
      level: custom
      type: long
      description: >
        Offset of bytes_address the memory allocation. Equal to bytes_address - allocation_base.

    - name: secondary
      level: custom
      type: nested
      enabled: false
      description: Additional matching details if available.
