---
- name: Credential_access
  title: Credential_access
  group: 2
  short: These fields contain information about API calls related to Credential Access.
  description: >
    These fields contain information about API calls related to a Credential Access event
    on Windows.

    Credential Access events are usually triggered by malicious programs in an attempt to
    dump credential stored in the memory of targeted processes, such as `lsass.exe` on
    Windows. To do, those programms will invoke specific API calls, such as `OpenProcess`
    or `OpenThread` which can be detected.

  reusable:
    top_level: true
    expected:
      - { at: process.Ext.api, as: parameters }
  type: group

  fields:
    - name: handle_type
      level: custom
      type: keyword
      description: >
        This parameter indicates whether the detected access was attempt against a process or a thread.
      example: process

    - name: desired_access_numeric
      level: custom
      type: long
      description: >
        This parameter indicates the numeric value of the `DesiredAccess` field passed to `OpenProcess` or `OpenThread`.

    - name: desired_access
      level: custom
      type: keyword
      description: >
        This parameter indicates the string value of the `DesiredAccess` field  to `OpenProcess` or `OpenThread`.
