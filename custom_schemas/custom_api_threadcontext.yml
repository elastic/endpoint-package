---
- name: threadcontext
  title: SetThreadContext
  group: 2
  description: >
    Fields describing SetThreadContext and Wow64SetThreadContext API calls.

  reusable:
    top_level: true
    expected:
      - { at: process.Ext.api, as: parameters }
  type: group

  fields:
    - name: context_flags
      level: custom
      type: unsigned_long
      description: >
        The bitmask of CPU registers operated on by this call. Corresponds to `CONTEXT.ContextFlags`
      example: 1048607

    - name: rip
      level: custom
      type: unsigned_long
      description: >
        The x64 RIP instruction pointer register.
      example: 140706153693184

    - name: rsp
      level: custom
      type: unsigned_long
      description: >
        The x64 RSP stack pointer register.
      example: 2431737462784

    - name: rax
      level: custom
      type: unsigned_long
      description: >
        The x64 RAX general purpose register. Return value in a __fastcall.
      example: 0

    - name: rcx
      level: custom
      type: unsigned_long
      description: >
        The x64 RCX general purpose register. First argument in a __fastcall.
      example: 1

    - name: rdx
      level: custom
      type: unsigned_long
      description: >
        The x64 RDX general purpose register. Second argument in a __fastcall.
      example: 2

    - name: r8
      level: custom
      type: unsigned_long
      description: >
        The x64 R8 general purpose register. Third argument in a __fastcall.
      example: 3

    - name: r9
      level: custom
      type: unsigned_long
      description: >
        The x64 R9 general purpose register. Fourth argument in a __fastcall.
      example: 4

    - name: rbp
      level: custom
      type: unsigned_long
      description: >
        The x64 RBP general purpose register.
      example: 0

    - name: rbx
      level: custom
      type: keyword
      description: >
        The x64 RBX general purpose register.
      example: 0

    - name: rsi
      level: custom
      type: keyword
      description: >
        The x64 RSI general purpose register.
      example: 0

    - name: rdi
      level: custom
      type: unsigned_long
      description: >
        The x64 RDI general purpose register.
      example: 0

    - name: eip
      level: custom
      type: unsigned_long
      description: >
        The x86 EIP instruction pointer register.
      example: 1472790528

    - name: esp
      level: custom
      type: unsigned_long
      description: >
        The x86 ESP stack pointer register.
      example: 15007744

    - name: ebp
      level: custom
      type: unsigned_long
      description: >
        The x86 EBP frame pointer register.
      example: 15006644

    - name: eax
      level: custom
      type: unsigned_long
      description: >
        The x86 EAX general purpose register. Return value in __cdecl, __stdcall, __thiscall and __fastcall.
      example: 0

    - name: ecx
      level: custom
      type: unsigned_long
      description: >
        The x86 ECX general purpose register. First argument in __fastcall and __thiscall.
      example: 0

    - name: edx
      level: custom
      type: unsigned_long
      description: >
        The x86 EDX general purpose register. Second argument in a __fastcall.
      example: 0

    - name: ebx
      level: custom
      type: unsigned_long
      description: >
        The x86 EBX general purpose register.
      example: 0

    - name: esi
      level: custom
      type: unsigned_long
      description: >
        The x86 ESI general purpose register.
      example: 0

    - name: edi
      level: custom
      type: unsigned_long
      description: >
        The x86 EDI general purpose register.
      example: 0

    