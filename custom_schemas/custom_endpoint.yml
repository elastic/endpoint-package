---
- name: endpoint
  title: Endpoint
  group: 2
  short: Fields describing the state of the Elastic Endpoint when an event occurs.
  description: >
    Fields describing the state of the Elastic Endpoint when an event occurs.
  type: group
  fields:
    - name: policy
      level: custom
      type: object
      description: The policy fields are used to hold information about applied policy.

    - name: policy.id
      level: custom
      type: keyword
      description: >
        ID of the policy that was active when the event was created.
      example: c2a9093e-e289-4c0a-aa44-8c32a414fa7a

    - name: policy.applied
      level: custom
      type: object
      description: information about the policy that is applied

    - name: policy.applied.actions
      level: custom
      type: nested
      enabled: false
      description: actions applied during the application of the policy

    - name: policy.applied.actions.name
      level: custom
      type: keyword
      description: name of the action that was applied

    - name: policy.applied.actions.message
      level: custom
      type: keyword
      description: message about the application of the action to further qualify the status of the action

    - name: policy.applied.actions.status
      level: custom
      type: keyword
      description: the status of the action

    - name: policy.applied.id
      level: custom
      type: keyword
      description: the id of the applied policy
      
    - name: policy.applied.status
      level: custom
      type: keyword
      description: the status of the applied policy

    - name: policy.applied.version
      level: custom
      type: keyword
      description: the version of this applied policy
    
    - name: policy.applied.name
      level: custom
      type: keyword
      description: the name of this applied policy

    - name: policy.applied.response
      level: custom
      type: object
      enabled: false
      description: the response of actions that failed in the applied policy

    - name: policy.applied.configurations
      level: custom
      type: object
      enabled: false
      description: the configurations of the applied policy

    - name: policy.applied.configurations.events
      level: custom
      type: object
      description: overall event collection configuration and status of the applied policy

    - name: policy.applied.configurations.events.concerned_actions
      level: custom
      type: keyword
      description: all actions that were taken for event collection

    - name: policy.applied.configurations.events.status
      level: custom
      type: keyword
      description: >
        the overall status of event collection, this is correlated to the status of concerned actions 
        but not a simple sum of the actions

    - name: policy.applied.configurations.logging
      level: custom
      type: object
      description: overall logging configuration and status of the applied policy

    - name: policy.applied.configurations.logging.concerned_actions
      level: custom
      type: keyword
      description: all actions that were taken for logging

    - name: policy.applied.configurations.logging.status
      level: custom
      type: keyword
      description: >
        the overall status of logging, this is correlated to the status of concerned actions but 
        not a simple sum of the actions

    - name: policy.applied.configurations.malware
      level: custom
      type: object
      description: overall malware configuration and status of the applied policy

    - name: policy.applied.configurations.malware.concerned_actions
      level: custom
      type: keyword
      description: all actions that were taken for malware

    - name: policy.applied.configurations.malware.status
      level: custom
      type: keyword
      description: >
        the overall status of malware, this is correlated to the status of concerned actions 
        but not a simple sum of the actions

    - name: policy.applied.configurations.streaming
      level: custom
      type: object
      description: overall data streaming configuration and status of the applied policy

    - name: policy.applied.configurations.streaming.concerned_actions
      level: custom
      type: keyword
      description: all actions that were taken for data streaming

    - name: policy.applied.configurations.streaming.status
      level: custom
      type: keyword
      description: >
        the overall status of data streaming, this is correlated to the status of concerned actions 
        but not a simple sum of the actions

    - name: policy.applied.artifacts
      level: custom
      type: object
      enabled: false
      description: information about protection artifacts applied.

    - name: policy.applied.artifacts.global
      level: custom
      type: object
      description: information about global protection artifacts applied.

    - name: policy.applied.artifacts.global.version
      level: custom
      type: keyword
      description: the version of global artifacts applied.

    - name: policy.applied.artifacts.global.identifiers
      level: custom
      type: nested
      description: the identifiers of global artifacts applied.

    - name: policy.applied.artifacts.global.identifiers.name
      level: custom
      type: keyword
      description: the name of global artifact applied.

    - name: policy.applied.artifacts.global.identifiers.sha256
      level: custom
      type: keyword
      description: the sha256 of global artifacts applied.

    - name: policy.applied.artifacts.user
      level: custom
      type: object
      description: information about user protection artifacts applied.

    - name: policy.applied.artifacts.user.version
      level: custom
      type: keyword
      description: the version of user artifacts applied.

    - name: policy.applied.artifacts.user.identifiers
      level: custom
      type: nested
      description: the identifiers of user artifacts applied.

    - name: policy.applied.artifacts.user.identifiers.name
      level: custom
      type: keyword
      description: the name of user artifact applied.

    - name: policy.applied.artifacts.user.identifiers.sha256
      level: custom
      type: keyword
      description: the sha256 of user artifacts applied.

    - name: group
      level: custom
      type: object
      description: Extended "group" field set

    - name: group.real
      level: custom
      type: object
      description: Group info prior to any setgid operations.

    - name: group.real.id
      level: custom
      type: keyword
      description: >
        Unique identifier for the group on the system/platform.

    - name: group.real.name
      level: custom
      type: keyword
      description: >
        Name of the group.

    - name: user
      level: custom
      type: object
      description: Extended "user" field set

    - name: user.real
      level: custom
      type: object
      description: User info prior to any setuid operations.

    - name: user.real.id
      level: custom
      type: keyword
      description: >
        One or multiple unique identifiers of the user.

    - name: user.real.name
      level: custom
      type: keyword
      description: >
        Short name or login of the user.

    - name: process
      level: custom
      type: object
      description: Extended "process" field set

    - name: process.authentication_id
      level: custom
      type: keyword
      description: >
        Process authentication ID

    - name: process.session
      level: custom
      type: keyword
      description: >
        Session information for the current process

    - name: process.parent
      level: custom
      type: object
      description: >
        Extended "process.parent" field set.

    - name: process.parent.real
      level: custom
      type: object
      description: >
        The field set containing parent process info in case of any ppid spoofing.

    - name: process.parent.real.pid
      level: custom
      type: long
      description: >
        The ppid of the process that actually spawned the current process, in case of
        ppid spoofing.

    - name: process.code_signature
      level: custom
      type: nested
      description: Nested version of ECS code_signature fieldset.

    - name: process.code_signature.exists
      level: core
      type: boolean
      description: Boolean to capture if a signature is present.
      example: "true"

    - name: process.code_signature.subject_name
      level: core
      type: keyword
      description: Subject name of the code signer
      example: Microsoft Corporation

    - name: process.code_signature.valid
      level: extended
      type: boolean
      short: Boolean to capture if the digital signature is verified against the binary content.
      example: "true"
      description: >
        Boolean to capture if the digital signature is verified against the binary content.

        Leave unpopulated if a certificate was unchecked.

    - name: process.code_signature.trusted
      level: extended
      type: boolean
      short: Stores the trust status of the certificate chain.
      example: "true"
      description: >
        Stores the trust status of the certificate chain.

        Validating the trust of the certificate chain may be complicated, and this field should only be populated
        by tools that actively check the status.


    - name: process.code_signature.status
      level: extended
      type: keyword
      short: Additional information about the certificate status.
      description: >
        Additional information about the certificate status.

        This is useful for logging cryptographic errors with the certificate validity or trust status.
        Leave unpopulated if the validity or trust of the certificate was unchecked.
      example: ERROR_UNTRUSTED_ROOT

    - name: process.parent.code_signature
      level: custom
      type: nested
      description: Nested version of ECS code_signature fieldset.

    - name: process.parent.code_signature.exists
      level: core
      type: boolean
      description: Boolean to capture if a signature is present.
      example: "true"

    - name: process.parent.code_signature.subject_name
      level: core
      type: keyword
      description: Subject name of the code signer
      example: Microsoft Corporation

    - name: process.parent.code_signature.valid
      level: extended
      type: boolean
      short: Boolean to capture if the digital signature is verified against the binary content.
      example: "true"
      description: >
        Boolean to capture if the digital signature is verified against the binary content.

        Leave unpopulated if a certificate was unchecked.

    - name: process.parent.code_signature.trusted
      level: extended
      type: boolean
      short: Stores the trust status of the certificate chain.
      example: "true"
      description: >
        Stores the trust status of the certificate chain.

        Validating the trust of the certificate chain may be complicated, and this field should only be populated
        by tools that actively check the status.


    - name: process.parent.code_signature.status
      level: extended
      type: keyword
      short: Additional information about the certificate status.
      description: >
        Additional information about the certificate status.

        This is useful for logging cryptographic errors with the certificate validity or trust status.
        Leave unpopulated if the validity or trust of the certificate was unchecked.
      example: ERROR_UNTRUSTED_ROOT

    - name: file
      level: custom
      type: object
      description: Extended "file" field set

    - name: file.windows
      level: custom
      type: object
      description: Platform-specific Windows fields

    - name: file.windows.zone_identifier
      level: custom
      type: keyword
      description: >
        Windows zone identifier for a file

    - name: file.original
      level: custom
      type: object
      description: Original file information during a modification event.

    - name: file.original.name
      level: custom
      type: keyword
      description: >
        Original file name prior to a modification event

    - name: file.original.path
      level: custom
      type: keyword
      description: >
        Original file path prior to a modification event

    - name: file.original.mode
      level: custom
      type: keyword
      description: >
        Original file mode prior to a modification event

    - name: file.original.uid
      level: custom
      type: keyword
      description: >
        The user ID (UID) or security identifier (SID) of the file owner.
      example: "1001"

    - name: file.original.owner
      level: custom
      type: keyword
      description: >
        File owner's username.
      example: alice

    - name: file.original.gid
      level: custom
      type: keyword
      description: >
        Primary group ID (GID) of the file.
      example: "1001"

    - name: file.original.group
      level: custom
      type: keyword
      description: >
        Primary group name of the file.
      example: alice

    - name: file.code_signature
      level: custom
      type: nested
      description: Nested version of ECS code_signature fieldset.

    - name: file.code_signature.exists
      level: core
      type: boolean
      description: Boolean to capture if a signature is present.
      example: "true"

    - name: file.code_signature.subject_name
      level: core
      type: keyword
      description: Subject name of the code signer
      example: Microsoft Corporation

    - name: file.code_signature.valid
      level: extended
      type: boolean
      short: Boolean to capture if the digital signature is verified against the binary content.
      example: "true"
      description: >
        Boolean to capture if the digital signature is verified against the binary content.

        Leave unpopulated if a certificate was unchecked.

    - name: file.code_signature.trusted
      level: extended
      type: boolean
      short: Stores the trust status of the certificate chain.
      example: "true"
      description: >
        Stores the trust status of the certificate chain.

        Validating the trust of the certificate chain may be complicated, and this field should only be populated
        by tools that actively check the status.


    - name: file.code_signature.status
      level: extended
      type: keyword
      short: Additional information about the certificate status.
      description: >
        Additional information about the certificate status.

        This is useful for logging cryptographic errors with the certificate validity or trust status.
        Leave unpopulated if the validity or trust of the certificate was unchecked.
      example: ERROR_UNTRUSTED_ROOT

    - name: artifact.name
      level: custom
      type: keyword
      description: >
        Name of artifact in use by endpoint when event was created.

    - name: artifact.version
      level: custom
      type: keyword
      description: >
        Version of artifact in use by endpoint when event was created.

    - name: artifact.hash
      level: custom
      type: keyword
      description: >
        Hash of artifact in use by endpoint when event was created.

    - name: system
      level: custom
      type: object
      description: System fields hold the endpoint and system's performance metrics

    - name: system.uptime
      level: custom
      type: object
      description: Number of seconds since boot

    - name: system.uptime.endpoint
      level: custom
      type: long
      description: Number of seconds since the endpoint was started

    - name: system.uptime.system
      level: custom
      type: long
      description: Number of seconds since the system was started

    - name: system.cpu
      level: custom
      type: object
      description: CPU statistics

    - name: system.cpu.endpoint
      level: custom
      type: object
      description: CPU metrics for the endpoint

    - name: system.cpu.endpoint.mean
      level: custom
      type: half_float
      description: Average CPU load used by the endpoint

    - name: system.cpu.endpoint.latest
      level: custom
      type: half_float
      description: Average CPU over the last sample interval

    - name: system.cpu.endpoint.histogram
      level: custom
      type: histogram
      description:
        This field defines an elasticsearch histogram field (https://www.elastic.co/guide/en/elasticsearch/reference/current/histogram.html#histogram)
        The values field includes 20 buckets (each bucket is 5%) representing the cpu usage
        The counts field includes 20 buckets of how many times the endpoint's cpu usage fell into each bucket

    - name: system.memory
      level: custom
      type: object
      description: Memory statistics

    - name: system.memory.endpoint
      level: custom
      type: object
      description: Endpoint memory utilization

    - name: system.memory.endpoint.private
      level: custom
      type: object
      description: The memory private to the endpoint

    - name: system.memory.endpoint.private.mean
      level: custom
      type: long
      description: Average memory usage by the endpoint since its start

    - name: system.memory.endpoint.private.latest
      level: custom
      type: long
      description: The memory usage by the endpoint for the last sample interval

    - name: system.disks
      level: custom
      type: nested
      description: An array of disk information for the host

    - name: system.disks.mount
      level: custom
      type: keyword
      description: The disks mount location

    - name: system.disks.free
      level: custom
      type: long
      description: The number of bytes marked as free on the disk

    - name: system.disks.total
      level: custom
      type: long
      description: The size of the disk in bytes

    - name: system.threads
      level: custom
      # using an object here even though it is actually an array because you can only have a limited number
      # of nested fields
      type: object
      enabled: false
      description: Statistics about the individual threads of the system (array)

    - name: dns
      level: custom
      type: object
      description: DNS fields that are not defined in core ECS

    - name: dns.status
      level: custom
      type: long
      description: DNS status field, uint32

    - name: dns.options
      level: custom
      type: keyword
      description: DNS options field, uint64, representing as a keyword to avoid overflows in ES

    - name: event
      level: custom
      type: object
      description: Custom fields relating to event information

    - name: event.process
      level: custom
      type: object
      description: Custom process information relating to the event

    - name: event.process.ancestry
      level: custom
      type: keyword
      description: An array of entity_ids indicating the ancestors for this event

    - name: dll.code_signature
      level: custom
      type: nested
      description: Nested version of ECS code_signature fieldset.

    - name: dll.code_signature.exists
      level: core
      type: boolean
      description: Boolean to capture if a signature is present.
      example: "true"

    - name: dll.code_signature.subject_name
      level: core
      type: keyword
      description: Subject name of the code signer
      example: Microsoft Corporation

    - name: dll.code_signature.valid
      level: extended
      type: boolean
      short: Boolean to capture if the digital signature is verified against the binary content.
      example: "true"
      description: >
        Boolean to capture if the digital signature is verified against the binary content.

        Leave unpopulated if a certificate was unchecked.

    - name: dll.code_signature.trusted
      level: extended
      type: boolean
      short: Stores the trust status of the certificate chain.
      example: "true"
      description: >
        Stores the trust status of the certificate chain.

        Validating the trust of the certificate chain may be complicated, and this field should only be populated
        by tools that actively check the status.


    - name: dll.code_signature.status
      level: extended
      type: keyword
      short: Additional information about the certificate status.
      description: >
        Additional information about the certificate status.

        This is useful for logging cryptographic errors with the certificate validity or trust status.
        Leave unpopulated if the validity or trust of the certificate was unchecked.
      example: ERROR_UNTRUSTED_ROOT