- name: '@timestamp'
  level: core
  required: true
  type: date
  description: 'Date/time when the event originated.

    This is the date/time extracted from the event, typically representing when the event was generated by the source.

    If the event source has no original timestamp, this value is typically populated by the first time the event was received by the pipeline.

    Required field for all events.'
  example: '2016-05-23T08:05:34.853Z'
  default_field: true
- name: message
  level: core
  type: match_only_text
  description: 'For log events the message field contains the log message, optimized for viewing in a log viewer.

    For structured logs without an original message field, other fields can be concatenated to form a human-readable summary of the event.

    If multiple messages exist, they can be combined into one message.'
  example: Credential access event
  default_field: true

- name: process
  title: Source Process
  group: 2
  description: >
    These fields contains information about the source process that emitted the event
  type: group
  default_field: true
  fields:
    - name: name
      level: custom
      type: keyword
      description: The name of the process triggering the credential access event.
      example: CredentialDumper.exe
    - name: Ext
      level: custom
      type: object
      description: Object for all custom defined fields to live in.
      default_field: false
    - name: Ext.api
      level: custom
      type: object
      description: Group information for API calls.
      default_field: false
    - name: Ext.api.name
      level: custom
      type: keyword
      description: The name of the API call that triggered the credential access event.
      example: 'OpenProcess'
    - name: Ext.api.parameters.desired_access_numeric
      type: long
      level: custom
      description: The DesiredAccess parameter (as a numerical value) provided to the API call
      example: 2097103
    - name: Ext.api.parameters.desired_access
      level: extended
      type: keyword
      ignore_above: 1024
      description: The DesiredAccess parameter (as an array of string) provided to the API call
      example: '["PROCESS_VM_OPERATION", "PROCESS_CREATE_PROCESS"]'
    - name: Ext.api.parameters.handle_type
      type: keyword
      level: custom
      description: 'The type of handle type invoked: process or thread'
      example: "process"
    - name: thread.Ext.call_stack_final_user_module.path
      level: custom
      type: keyword
      example: "C:\\Windows\\System32\\example.dll"
      description: >
        The file path of the call_stack_final_user_module.
    - name: thread.Ext.call_stack
      level: extended
      type: keyword
      ignore_above: 1024
      example: '[{"module_name":"ntdll.dll", "instruction_pointer": 1999380780}]'
    - name: thread.Ext.call_stack.module_name
      level: custom
      type: keyword
      description: The name of the DLL/module containing `instruction_pointer`.
      example:
    - name: thread.Ext.call_stack.instruction_pointer
      level: custom
      type: long
      description: The return address of this stack frame.
      example: 1999380780
    - name: thread.Ext.call_stack_contains_unbacked
      type: boolean
      level: custom
      example: 'true'
      description: Indicates whether the creating thread's stack contains frames pointing outside any known executable image.
- name: Target
  title: Target Process
  group: 2
  description: >
    These fields contains information about the target process that emitted the event.
  type: group
  default_field: true
  fields:
    - name: process.name
      level: custom
      type: keyword
      description: The name of the process being targetted by the credential access.
      example: 'lsass.exe'
    - name: process.pid
      level: custom
      type: long
      description: The name of the process being targetted by the credential access.
      example: 1234
