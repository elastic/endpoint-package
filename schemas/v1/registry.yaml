title: registry
fields:

  - name: agent
    description: 'The agent fields contain the data about the software entity, if
      any, that collects, detects, or observes events on a host, or takes measurements
      on a host.

      Examples include Beats. Agents may also run on observers. ECS agent.* fields
      shall be populated with details of the agent running on the host or observer
      where the event happened or the measurement was taken.'
    fields:

      - name: id
        type: keyword
        description: 'Unique identifier of this agent (if one exists).

          Example: For Beats this would be beat.id.'
        example: 8a4f500d

      - name: type
        type: keyword
        description: 'Type of the agent.

          The agent type stays always the same and should be given by the agent used.
          In case of Filebeat the agent would always be Filebeat also if two Filebeat
          instances are run on the same machine.'
        example: filebeat

      - name: version
        type: keyword
        description: Version of the agent.
        example: 6.0.0-rc2

  - name: '@timestamp'
    type: date
    description: 'Date/time when the event originated.

      This is the date/time extracted from the event, typically representing when
      the event was generated by the source.

      If the event source has no original timestamp, this value is typically populated
      by the first time the event was received by the pipeline.

      Required field for all events.'
    example: '2016-05-23T08:05:34.853Z'

  - name: message
    type: text
    description: 'For log events the message field contains the log message, optimized
      for viewing in a log viewer.

      For structured logs without an original message field, other fields can be concatenated
      to form a human-readable summary of the event.

      If multiple messages exist, they can be combined into one message.'
    example: Hello World

  - name: ecs
    description: Meta-information specific to ECS.
    fields:

      - name: version
        type: keyword
        description: 'ECS version this event conforms to. `ecs.version` is a required
          field and must exist in all events.

          When querying across multiple indices -- which may conform to slightly different
          ECS versions -- this field lets integrations adjust to the schema version
          of the events.'
        example: 1.0.0

  - name: endpoint
    description: Fields describing the state of the Elastic Endpoint when an event
      occurs.
    fields:

      - name: group
        description: Extended "group" field set
        fields:

          - name: real
            description: Group info prior to any setgid operations.
            fields:

              - name: id
                type: keyword
                description: Unique identifier for the group on the system/platform.

              - name: name
                type: keyword
                description: Name of the group.

      - name: user
        description: Extended "user" field set
        fields:

          - name: real
            description: User info prior to any setuid operations.
            fields:

              - name: id
                type: keyword
                description: One or multiple unique identifiers of the user.

              - name: name
                type: keyword
                description: Short name or login of the user.

  - name: event
    description: 'The event fields are used for context information about the log
      or metric event itself.

      A log is defined as an event containing details of something that happened.
      Log events must include the time at which the thing happened. Examples of log
      events include a process starting on a host, a network packet being sent from
      a source to a destination, or a network connection between a client and a server
      being initiated or closed. A metric is defined as an event containing one or
      more numerical or categorical measurements and the time at which the measurement
      was taken. Examples of metric events include memory pressure measured on a host,
      or vulnerabilities measured on a scanned host.'
    fields:

      - name: action
        type: keyword
        description: 'The action captured by the event.

          This describes the information in the event. It is more specific than `event.category`.
          Examples are `group-add`, `process-started`, `file-created`. The value is
          normally defined by the implementer.'
        example: user-password-change

      - name: category
        type: keyword
        description: 'This is one of four ECS Categorization Fields, and indicates
          the second level in the ECS category hierarchy.

          `event.category` represents the "big buckets" of ECS categories. For example,
          filtering on `event.category:process` yields all events relating to process
          activity. This field is closely related to `event.type`, which is used as
          a subcategory.

          This field is an array. This will allow proper categorization of some events
          that fall in multiple categories.'
        example: authentication
        allowed_values:

          - name: authentication
            description: 'Events in this category are related to the challenge and
              response process in which credentials are supplied and verified to allow
              the creation of a session. Common sources for these logs are Windows
              event logs and ssh logs. Visualize and analyze events in this category
              to look for failed logins, and other authentication-related activity.

              '
            expected_event_types:
              - start
              - end
              - info

          - name: database
            description: 'The database category denotes events and metrics relating
              to a data storage and retrieval system. Note that use of this category
              is not limited to relational database systems. Examples include event
              logs from MS SQL, MySQL, Elasticsearch, MongoDB, etc. Use this category
              to visualize and analyze database activity such as accesses and changes.

              '
            expected_event_types:
              - access
              - change
              - info
              - error

          - name: driver
            description: 'Events in the driver category have to do with operating
              system device drivers and similar software entities such as Windows
              drivers, kernel extensions, kernel modules, etc.

              Use events and metrics in this category to visualize and analyze driver-related
              activity and status on hosts.

              '
            expected_event_types:
              - change
              - end
              - info
              - start

          - name: file
            description: 'Relating to a set of information that has been created on,
              or has existed on a filesystem. Use this category of events to visualize
              and analyze the creation, access, and deletions of files. Events in
              this category can come from both host-based and network-based sources.
              An example source of a network-based detection of a file transfer would
              be the Zeek file.log.

              '
            expected_event_types:
              - change
              - creation
              - deletion
              - info

          - name: host
            description: 'Use this category to visualize and analyze information such
              as host inventory or host lifecycle events.

              Most of the events in this category can usually be observed from the
              outside, such as from a hypervisor or a control plane''s point of view.
              Some can also be seen from within, such as "start" or "end".

              Note that this category is for information about hosts themselves; it
              is not meant to capture activity "happening on a host".

              '
            expected_event_types:
              - access
              - change
              - end
              - info
              - start

          - name: intrusion_detection
            description: 'Relating to intrusion detections from IDS/IPS systems and
              functions, both network and host-based. Use this category to visualize
              and analyze intrusion detection alerts from systems such as Snort, Suricata,
              and Palo Alto threat detections.

              '
            expected_event_types:
              - info

          - name: malware
            description: 'Malware detection events and alerts. Use this category to
              visualize and analyze malware detections from EDR/EPP systems such as
              Elastic Endpoint Security, Symantec Endpoint Protection, Crowdstrike,
              and network IDS/IPS systems such as Suricata, or other sources of malware-related
              events such as Palo Alto Networks threat logs and Wildfire logs.

              '
            expected_event_types:
              - info

          - name: package
            description: 'Relating to software packages installed on hosts. Use this
              category to visualize and analyze inventory of software installed on
              various hosts, or to determine host vulnerability in the absence of
              vulnerability scan data.

              '
            expected_event_types:
              - access
              - change
              - deletion
              - info
              - installation
              - start

          - name: process
            description: 'Use this category of events to visualize and analyze process-specific
              information such as lifecycle events or process ancestry.

              '
            expected_event_types:
              - access
              - change
              - end
              - info
              - start

          - name: web
            description: 'Relating to web server access. Use this category to create
              a dashboard of web server/proxy activity from apache, IIS, nginx web
              servers, etc. Note: events from network observers such as Zeek http
              log may also be included in this category.

              '
            expected_event_types:
              - access
              - error
              - info

      - name: id
        type: keyword
        description: Unique ID to describe the event.
        example: 8a4f500d

      - name: kind
        type: keyword
        description: 'This is one of four ECS Categorization Fields, and indicates
          the highest level in the ECS category hierarchy.

          `event.kind` gives high-level information about what type of information
          the event contains, without being specific to the contents of the event.
          For example, values of this field distinguish alert events from metric events.

          The value of this field can be used to inform how these kinds of events
          should be handled. They may warrant different retention, different access
          control, it may also help understand whether the data coming in at a regular
          interval or not.'
        example: alert
        allowed_values:

          - name: alert
            description: 'This value indicates an event that describes an alert or
              notable event, triggered by a detection rule.

              `event.kind:alert` is often populated for events coming from firewalls,
              intrusion detection systems, endpoint detection and response systems,
              and so on.

              '

          - name: event
            description: 'This value is the most general and most common value for
              this field. It is used to represent events that indicate that something
              happened.

              '

          - name: metric
            description: 'This value is used to indicate that this event that a numeric
              measurement was taken at given point in time.

              Examples include CPU utilization, memory usage, or a vulnerability scan
              result.

              Metric events are often collected on a predictable frequency, such as
              once every few seconds, or once a minute.

              '

          - name: state
            description: 'This value is similar to metric, except that the entity
              being measured does not provide a numeric metric value, but rather one
              of a fixed set of conditions or states. For example a periodic event
              reporting a "fin_wait" state of a TCP connection on a host might use
              `event.type:state`.

              '

          - name: pipeline_error
            description: 'This value indicates that an error occurred during the ingestion
              of this event, and that event data may be missing, inconsistent, or
              incorrect. `event.kind:pipeline_error` is often associated with parsing
              errors.

              '

          - name: signal
            description: 'This value is used by the Elastic SIEM app to denote an
              Elasticsearch document that was created by a SIEM detection engine rule.

              A signal will typically trigger a notification that something meaningful
              happened and should be investigated.

              Usage of this value is reserved, and pipelines should not populate `event.kind`
              with the value "signal".

              '

      - name: module
        type: keyword
        description: 'Name of the module this data is coming from.

          If your monitoring agent supports the concept of modules or plugins to process
          events of a given source (e.g. Apache logs), `event.module` should contain
          the name of this module.'
        example: apache

      - name: type
        type: keyword
        description: 'This is one of four ECS Categorization Fields, and indicates
          the third level in the ECS category hierarchy.

          `event.type` represents a categorization "sub-bucket" that, when used along
          with the `event.category` field values, enables filtering events down to
          a level appropriate for single visualization.

          This field is an array. This will allow proper categorization of some events
          that fall in multiple event types.'
        allowed_values:

          - name: access
            description: 'The access event type is used for the subset of events within
              a category that indicate that something was accessed. Common examples
              include `event.category:database AND event.type:access`, or `event.category:file
              AND event.type:access`. Note for file access, both directory listings
              and file opens should be included in this subcategory. You can further
              distinguish access operations using the ECS `event.action` field.

              '

          - name: change
            description: 'The change event type is used for the subset of events within
              a category that indicate that something has changed. If semantics best
              describe an event as modified, then include them in this subcategory.
              Common examples include `event.category:process AND event.type:change`,
              and `event.category:file AND event.type:change`. You can further distinguish
              change operations using the ECS `event.action` field.

              '

          - name: creation
            description: 'The "creation" event type is used for the subset of events
              within a category that indicate that something was created. A common
              example is `event.category:file AND event.type:creation`.

              '

          - name: deletion
            description: 'The deletion event type is used for the subset of events
              within a category that indicate that something was deleted. A common
              example is `event.category:file AND event.type:deletion` to indicate
              that a file has been deleted.

              '

          - name: end
            description: 'The end event type is used for the subset of events within
              a category that indicate something has ended. A common example is `event.category:process
              AND event.type:end`.

              '

          - name: error
            description: 'The error event type is used for the subset of events within
              a category that indicate or describe an error. A common example is `event.category:database
              AND event.type:error`. Note that pipeline errors that occur during the
              event ingestion process should not use this `event.type` value. Instead,
              they should use `event.kind:pipeline_error`.

              '

          - name: info
            description: 'The info event type is used for the subset of events within
              a category that indicate that they are purely informational, and don''t
              report a state change, or any type of action. For example, an initial
              run of a file integrity monitoring system (FIM), where an agent reports
              all files under management, would fall into the "info" subcategory.
              Similarly, an event containing a dump of all currently running processes
              (as opposed to reporting that a process started/ended) would fall into
              the "info" subcategory. An additional common examples is `event.category:intrusion_detection
              AND event.type:info`.

              '

          - name: installation
            description: 'The installation event type is used for the subset of events
              within a category that indicate that something was installed. A common
              example is `event.category:package` AND `event.type:installation`.

              '

          - name: start
            description: 'The start event type is used for the subset of events within
              a category that indicate something has started. A common example is
              `event.category:process AND event.type:start`.

              '

  - name: group
    description: The group fields are meant to represent groups that are relevant
      to the event.
    fields:

      - name: id
        type: keyword
        description: Unique identifier for the group on the system/platform.

      - name: name
        type: keyword
        description: Name of the group.

  - name: host
    description: 'A host is defined as a general computing instance.

      ECS host.* fields should be populated with details about the host on which the
      event happened, or from which the measurement was taken. Host types include
      hardware, virtual machines, Docker containers, and Kubernetes nodes.'
    fields:

      - name: geo
        description: 'Geo fields can carry data about a specific location related
          to an event.

          This geolocation information can be derived from techniques such as Geo
          IP, or be user-supplied.'
        fields:

          - name: city_name
            type: keyword
            description: City name.
            example: Montreal

          - name: continent_name
            type: keyword
            description: Name of the continent.
            example: North America

          - name: country_iso_code
            type: keyword
            description: Country ISO code.
            example: CA

          - name: country_name
            type: keyword
            description: Country name.
            example: Canada

          - name: location
            type: geo_point
            description: Longitude and latitude.
            example: '{ "lon": -73.614830, "lat": 45.505918 }'

          - name: region_iso_code
            type: keyword
            description: Region ISO code.
            example: CA-QC

          - name: region_name
            type: keyword
            description: Region name.
            example: Quebec

      - name: hostname
        type: keyword
        description: 'Hostname of the host.

          It normally contains what the `hostname` command returns on the host machine.'

      - name: ip
        type: ip
        description: Host ip addresses.

      - name: name
        type: keyword
        description: 'Name of the host.

          It can contain what `hostname` returns on Unix systems, the fully qualified
          domain name, or a name specified by the user. The sender decides which value
          to use.'

      - name: os
        description: The OS fields contain information about the operating system.
        fields:

          - name: name
            type: keyword
            description: Operating system name, without the version.
            example: Mac OS X

          - name: platform
            type: keyword
            description: Operating system platform (such centos, ubuntu, windows).
            example: darwin

          - name: version
            type: keyword
            description: Operating system version as a raw string.
            example: 10.14.1

  - name: process
    description: 'These fields contain information about a process.

      These fields can help you correlate metrics information with a process id/name
      from a log message.  The `process.pid` often stays in the metric itself and
      is copied to the global field for correlation.'
    fields:

      - name: entity_id
        type: keyword
        description: 'Unique identifier for the process.

          The implementation of this is specified by the data source, but some examples
          of what could be used here are a process-generated UUID, Sysmon Process
          GUIDs, or a hash of some uniquely identifying components of a process.

          Constructing a globally unique identifier is a common practice to mitigate
          PID reuse as well as to identify a specific process over time, across multiple
          monitored hosts.'
        example: c2c455d9f99375d

      - name: executable
        type: keyword
        description: Absolute path to the process executable.
        example: /usr/bin/ssh

      - name: name
        type: keyword
        description: 'Process name.

          Sometimes called program name or similar.'
        example: ssh

      - name: pid
        type: long
        description: Process id.
        example: 4242

      - name: thread
        description: The thread fields are used to describe by which process thread
          the event belongs to.
        fields:

          - name: id
            type: long
            description: Thread ID.
            example: 4242

  - name: registry
    description: Fields related to Windows Registry operations.
    fields:

      - name: data
        description: TODO
        fields:

          - name: bytes
            type: keyword
            description: 'Original bytes written with base64 encoding.

              For Windows registry operations, such as SetValueEx and RegQueryValueEx,
              this corresponds to the data pointed by `lp_data`. This is optional
              but provides better recoverability and should be populated for REG_BINARY
              encoded values.'
            example: ZQBuAC0AVQBTAAAAZQBuAAAAAAA=

          - name: strings
            type: keyword
            description: 'Content when writing string types.

              Populated as an array when writing string data to the registry. For
              single string registry types (REG_SZ, REG_EXPAND_SZ), this should be
              an array with one string. For sequences of string with REG_MULTI_SZ,
              this array will be variable length. For numeric data, such as REG_DWORD
              and REG_QWORD, this should be populated with the decimal representation
              (e.g `"1"`).'
            example: '["C:\rta\red_ttp\bin\myapp.exe"]'

      - name: hive
        type: keyword
        description: Abbreviated name for the hive.
        example: HKLM

      - name: key
        type: keyword
        description: Hive-relative path of keys.
        example: SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution
          Options\winword.exe

      - name: path
        type: keyword
        description: Full path, including hive, key and value
        example: HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution
          Options\winword.exe\Debugger

      - name: value
        type: keyword
        description: Name of the value written.
        example: Debugger

  - name: user
    description: 'The user fields describe information about the user that is relevant
      to the event.

      Fields can have one entry or multiple entries. If a user has more than one id,
      provide an array that includes all of them.'
    fields:

      - name: domain
        type: keyword
        description: 'Name of the directory the user is a member of.

          For example, an LDAP or Active Directory domain name.'

      - name: id
        type: keyword
        description: Unique identifiers of the user.

      - name: name
        type: keyword
        description: Short name or login of the user.
        example: albert
