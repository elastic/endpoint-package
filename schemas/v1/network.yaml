---
title: Elastic Endpoint Network/DNS Events
fields:

- name: "@timestamp"
  type: date
  description: >
    Date/time when the event originated.

    This is the date/time extracted from the event, typically representing when the event was generated by the source.

    If the event source has no original timestamp, this value is typically populated by the first time the event was received by the pipeline.

    Required field for all events.

- name: message
  type: text
  description: >
    For log events the message field contains the log message, optimized for viewing in a log viewer.

    For structured logs without an original message field, other fields can be concatenated to form a human-readable summary of the event.

    If multiple messages exist, they can be combined into one message.

- name: host
  description: >
    The host fields are used to describe the host that's publishing data.
  fields:

  - name: geo
    description: >
      Geo fields can carry data about a specific location related to an event.
    endpoint: false
    fields:

    - name: location
      type: geo_point
      description: >
        Longitude and latitude.
      example: '{ "lon": -73.614830, "lat": 45.505918 }'

    - name: continent_name
      type: keyword
      description: >
        Name of the continent.
      example: North America

    - name: country_name
      type: keyword
      description: >
        Country name.
      example: Canada

    - name: region_name
      type: keyword
      description: >
        Region name.
      example: Quebec

    - name: city_name
      type: keyword
      description: >
        City name.
      example: Montreal

    - name: country_iso_code
      type: keyword
      description: >
        Country ISO code.
      example: CA

    - name: region_iso_code
      type: keyword
      description: >
        Region ISO code.
      example: CA-QC

  - name: os
    description: >
      The description of the operating system.
    fields:

    - name: platform
      type: keyword
      description: >
        Currently we just try use the non-normalized "name" (i.e. macos). See https://www.elastic.co/guide/en/ecs/current/ecs-os.html for
        how we should be mapping this
      example: darwin

    - name: name
      type: keyword
      description: >
        Currently we just normalize the name (i.e. macOS, Windows, Linux). See https://www.elastic.co/guide/en/ecs/current/ecs-os.html for
        how we should be mapping this
      example: Mac OS X

    - name: version
      type: keyword
      description: >
        Operating system version as a raw string.
      example: 10.14.1

  - name: ip
    type: keyword
    description: >
      The IP address of the endpoint.
    example: 10.0.1.5

  - name: hostname
    type: keyword
    description: >
      The hostname of the endpoint.
    example: laptop-mbp

  - name: name
    type: keyword
    description: >
      The name of the endpoint (same as hostname).
    example: laptop-mbp

- name: event
  description: >
    The event fields are used to describe the event metadata.
  fields:

  - name: module
    type: keyword
    description: >
      Hardcode to "endpoint".
    example: endpoint

  - name: kind
    type: keyword
    description: >
      The event kind.
    example: event

  - name: category
    type: keyword
    description: >
      The event category.
    example: process

  - name: type
    type: keyword
    description: >
      The event type.
    example: create, info, end, change

  - name: action
    type: keyword
    description: >
      The event action.
    example: library_load

- name: agent
  description: >
    The agent fields are used to describe by which endpoint information was collected.
  fields:

  - name: version
    type: keyword
    description: >
      Version of the endpoint publishing the event.
    example: 5.31.2

  - name: type
    type: keyword
    description: >
      Endpoint.
    example: endpoint

  - name: id
    type: keyword
    description: >
      Unique sensor identifier.
    example: 8a4f500d

- name: group
  description: >
    The group fields are used to describe by which group the event belongs to.
  fields:

  - name: id
    type: keyword
    description: >
      Unique identifier for the group on the system/platform.

  - name: name
    type: keyword
    description: >
      Name of the group.

- name: user
  description: >
    The user fields are used to describe by which user the event belongs to. In this case the "effective" user and group
  fields:

  - name: id
    type: keyword
    description: >
      One or multiple unique identifiers of the user.

  - name: name
    type: keyword
    description: >
      Short name or login of the user.
    example: albert

- name: process
  description: >
    The process fields are used to describe by which process the event belongs to.
  fields:

  - name: pid
    type: long
    description: >
      Process id.

  - name: name
    type: keyword
    description: >
      Process name.

      Sometimes called program name or similar.

  - name: executable
    type: keyword
    description: >
      Absolute path to the process executable.

  - name: thread
    description: >
      The thread fields are used to describe by which process thread the event belongs to.
    fields:

    - name: id
      type: long
      description: >
        Thread ID.

  - name: network
    description: >
      The network is defined as the communication path over which a host or network event happens.
    fields:

    - name: type
      type: keyword
      description: >
        In the OSI Model this would be the Network Layer. ipv4, ipv6, ipsec, pim, etc

    - name: iana_number
      type: keyword
      description: >
        IANA Protocol Number.

    - name: transport
      type: keyword
      description: >
        Protocol Name corresponding to the field `iana_number`.

    - name: protocol
      type: keyword
      description: >
        L7 Network protocol name.

    - name: direction
      type: keyword
      description: >
        Direction of the network traffic.

    - name: community_id
      type: keyword
      description: >
        Learn more at https://github.com/corelight/community-id-spec.

    - name: bytes
      type: long
      format: bytes
      description: >
        Total bytes transferred in both directions.

    - name: packets
      type: long
      description: >
        Total packets transferred in both directions.

  - name: source
    description: >
      Source fields describe details about the source of a packet/event.
    fields:

    - name: address
      type: keyword
      description: >
        Some event source addresses are defined ambiguously. The event will
        sometimes list an IP, a domain or a unix socket.  You should always
        store the raw address in the `.address` field.
        Then it should be duplicated to `.ip` or `.domain`, depending on which
        one it is.

    - name: ip
      type: ip
      description: >
        IP address of the source.
        Can be one or multiple IPv4 or IPv6 addresses.

    - name: port
      type: long
      description: >
        Port of the source.

    - name: domain
      type: keyword
      description: >
        Source domain.

    - name: registered_domain
      type: keyword
      description: >
        The highest registered source domain, stripped of the subdomain.

    - name: top_level_domain
      type: keyword
      description: >
        The effective top level domain (com, org, net, co.uk).
      example: co.uk

    - name: bytes
      format: bytes
      type: long
      description: >
        Bytes sent from the source to the destination.

    - name: packets
      type: long
      description: >
        Packets sent from the source to the destination.

  - name: destination
    description: >
      Destination fields describe details about the destination of a packet/event.
    fields:

    - name: address
      type: keyword
      description: >
        Some event destination addresses are defined ambiguously. The event will
        sometimes list an IP, a domain or a unix socket.  You should always
        store the raw address in the `.address` field.
        Then it should be duplicated to `.ip` or `.domain`, depending on which
        one it is.

    - name: ip
      type: ip
      description: >
        IP address of the destination.
        Can be one or multiple IPv4 or IPv6 addresses.

    - name: port
      type: long
      description: >
        Port of the destination.

    - name: domain
      type: keyword
      description: >
        Destination domain.

    - name: registered_domain
      type: keyword
      description: >
        The highest registered destination domain, stripped of the subdomain.

    - name: top_level_domain
      type: keyword
      description: >
        The effective top level domain (com, org, net, co.uk).
      example: co.uk

    - name: bytes
      format: bytes
      type: long
      description: >
        Bytes sent from the destination to the source.

    - name: packets
      type: long
      description: >
        Packets sent from the destination to the source.

- name: http
  description: >
    Fields describing an HTTP request.
  fields:

  - name: response
    fields:

    - name: status_code
      type: long
      description: >
        HTTP response status code.
      example: 404

    - name: body
      fields:

      - name: content
        type: keyword
        description: >
          The full HTTP response body.
        multi_fields:
        - type: text
          name: text

      - name: bytes
        type: long
        format: bytes
        description: >
          Size in bytes of the response body.

    - name: version
      level: extended
      type: keyword
      description: >
        HTTP version.

    - name: bytes
      type: long
      format: bytes
      description: >
        Total size in bytes of the response (body and headers).

  - name: dns
    description: >
      Fields describing DNS queries and answers.
    fields:

    - name: question
      fields:

      - name: name
        type: keyword
        description: >
          The name being queried.

      - name: type
        type: keyword
        description: >
          The type of record being queried.

      - name: registered_domain
        type: keyword
        description: >
          The highest registered domain, stripped of the subdomain.

      - name: top_level_domain
        type: keyword
        description: >
          The effective top level domain (com, org, net, co.uk).

      - name: subdomain
        type: keyword
        description: >
          The subdomain of the domain.

    - name: resolved_ip
      type: ip
      description: >
        Array containing all IPs.

- name: endpoint
  description: >
    Endpoint custom fields.
  fields:

  - name: group
    description: >
      Extended "group" field set
    fields:

    - name: real
      description: >
        Group info prior to any setgid operations.
      fields:

      - name: id
        type: keyword
        description: >
          Unique identifier for the group on the system/platform.

      - name: name
        type: keyword
        description: >
          Name of the group.

  - name: user
    description: >
      Extended "user" field set
    fields:

    - name: real
      description: >
        User info prior to any setuid operations.
      fields:

      - name: id
        type: keyword
        description: >
          One or multiple unique identifiers of the user.

      - name: name
        type: keyword
        description: >
          Short name or login of the user.
        example: albert

  - name: process
    description: >
      Extended "process" field set
    fields:

    - name: entity_id
      type: keyword
      description: >
        The globally unique identifier for the process
