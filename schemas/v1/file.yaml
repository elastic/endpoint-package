---
title: Elastic Endpoint File Events
fields:

- name: "@timestamp"
  type: date
  description: >
    Date/time when the event originated.

    This is the date/time extracted from the event, typically representing when the event was generated by the source.

    If the event source has no original timestamp, this value is typically populated by the first time the event was received by the pipeline.

    Required field for all events.

- name: message
  type: text
  description: >
    For log events the message field contains the log message, optimized for viewing in a log viewer.

    For structured logs without an original message field, other fields can be concatenated to form a human-readable summary of the event.

    If multiple messages exist, they can be combined into one message.

- name: ecs
  title: ECS
  description: >
    Meta-information specific to ECS.
  fields:

    - name: version
      type: keyword
      description: >
        ECS version this event conforms to. `ecs.version` is a required field and must exist in all events.

        When querying across multiple indices -- which may conform to slightly
        different ECS versions -- this field lets integrations adjust to the
        schema version of the events.
      example: 1.0.0

- name: host
  description: >
    The host fields are used to describe the host that's publishing data.
  fields:

  - name: geo
    description: >
      Geo fields can carry data about a specific location related to an event.
    endpoint: false
    fields:

    - name: location
      type: geo_point
      description: >
        Longitude and latitude.
      example: '{ "lon": -73.614830, "lat": 45.505918 }'

    - name: continent_name
      type: keyword
      description: >
        Name of the continent.
      example: North America

    - name: country_name
      type: keyword
      description: >
        Country name.
      example: Canada

    - name: region_name
      type: keyword
      description: >
        Region name.
      example: Quebec

    - name: city_name
      type: keyword
      description: >
        City name.
      example: Montreal

    - name: country_iso_code
      type: keyword
      description: >
        Country ISO code.
      example: CA

    - name: region_iso_code
      type: keyword
      description: >
        Region ISO code.
      example: CA-QC

  - name: os
    description: >
      The description of the operating system.
    fields:

    - name: platform
      type: keyword
      description: >
        Currently we just try use the non-normalized "name" (i.e. macos). See https://www.elastic.co/guide/en/ecs/current/ecs-os.html for
        how we should be mapping this
      example: darwin

    - name: name
      type: keyword
      description: >
        Currently we just normalize the name (i.e. macOS, Windows, Linux). See https://www.elastic.co/guide/en/ecs/current/ecs-os.html for
        how we should be mapping this
      example: Mac OS X

    - name: version
      type: keyword
      description: >
        Operating system version as a raw string.
      example: 10.14.1

  - name: ip
    type: ip
    description: >
      The IP address of the endpoint.
    example: 10.0.1.5

  - name: hostname
    type: keyword
    description: >
      The hostname of the endpoint.
    example: laptop-mbp

  - name: name
    type: keyword
    description: >
      The name of the endpoint (same as hostname).
    example: laptop-mbp

- name: event
  description: >
    The event fields are used to describe the event metadata.
  fields:

  - name: id
    type: keyword
    description: >
      Unique ID to describe the event.
    example: 8a4f500d

  - name: module
    type: keyword
    description: >
      Hardcode to endpoint.
    example: endpoint

  - name: kind
    type: keyword
    description: >
      The event kind.
    example: event

  - name: category
    type: keyword
    description: >
      The event category.
    example: file

  - name: type
    type: keyword
    description: >
      The event type.
    example: file_create

- name: agent
  description: >
    The agent fields are used to describe by which endpoint information was collected.
  fields:

  - name: version
    type: keyword
    description: >
      Version of the endpoint publishing the event.
    example: 5.31.2

  - name: type
    type: keyword
    description: >
      Endpoint.
    example: endpoint

  - name: id
    type: keyword
    description: >
      Unique sensor identifier.
    example: 8a4f500d

- name: file
  description: >
    TODO
  fields:

  - name: name
    type: keyword
    description: >
      Name of the file.

  - name: path
    type: keyword
    description: >
      Path to the file.

  - name: mode
    type: keyword
    description: Mode of the file in octal representation.
    example: '0640'

  - name: inode
    type: keyword
    description: Inode representing the file in the filesystem.
    example: '256383'

  - name: uid
    type: keyword
    description: >
      The user ID (UID) or security identifier (SID) of the file owner.
    example: '1001'

  - name: owner
    type: keyword
    description: File owner's username.
    example: alice

  - name: gid
    type: keyword
    description: Primary group ID (GID) of the file.
    example: '1001'

  - name: group
    type: keyword
    description: Primary group name of the file.
    example: alice

  - name: hash
    description: >
      The hash fields are used to describe the hash values for a particular process.
    fields:

    - name: md5
      type: keyword
      description: >
        MD5 hash.

    - name: sha1
      type: keyword
      description: >
        SHA1 hash.

    - name: sha256
      type: keyword
      description: >
        SHA256 hash.

- name: process
  description: >
    The process fields are used to describe by which process the event belongs to.
  fields:

  - name: pid
    type: long
    description: >
      Process id.

  - name: name
    type: keyword
    description: >
      Process name.

      Sometimes called program name or similar.

  - name: executable
    type: keyword
    description: >
      Absolute path to the process executable.

- name: endpoint
  description: >
    Endpoint custom fields.
  fields:

  - name: process
    description: >
      Extended "process" field set
    fields:

    - name: entity_id
      type: keyword
      description: >
        The globally unique identifier for the process

  - name: file
    description: >
      Extended "file" field set
    fields:

    - name: windows
      description: >
        Platform-specific Windows fields
      fields:

      - name: zone_identifier
        type: keyword
        description:
          Windows zone identifier for a file

    - name: original
      description: >
        Original file information during a modification event.
      fields:

      - name: name
        type: keyword
        description: >
          Original file name prior to a modification event

      - name: path
        type: keyword
        description: >
          Original file path prior to a modification event

      - name: mode
        type: keyword
        description: >
          Original file mode prior to a modification event

      - name: uid
        type: keyword
        description: >
          The user ID (UID) or security identifier (SID) of the file owner.
        example: '1001'

      - name: owner
        type: keyword
        description: File owner's username.
        example: alice

      - name: gid
        type: keyword
        description: Primary group ID (GID) of the file.
        example: '1001'

      - name: group
        type: keyword
        description: Primary group name of the file.
        example: alice
