overview:
  name: Windows API
  description: This event is generated when ETW Threat-Intelligence events are generated.
identification:
  filter:
    event.dataset: endpoint.events.api
    event.module: endpoint
    event.provider: Microsoft-Windows-Threat-Intelligence
    host.os.type: windows
  os:
  - windows
  data_stream: logs-endpoint.events.api-*
fields:
  endpoint:
  - '@timestamp'
  - Target.process.Ext.created_suspended
  - Target.process.Ext.desktop_name
  - Target.process.Ext.protection
  - Target.process.Ext.token.impersonation_level
  - Target.process.Ext.token.integrity_level_name
  - Target.process.Ext.token.sid
  - Target.process.entity_id
  - Target.process.executable
  - Target.process.name
  - Target.process.pid
  - agent.id
  - agent.type
  - agent.version
  - data_stream.dataset
  - data_stream.namespace
  - data_stream.type
  - ecs.version
  - elastic.agent.id
  - event.category
  - event.created
  - event.dataset
  - event.id
  - event.kind
  - event.module
  - event.outcome
  - event.provider
  - event.sequence
  - event.type
  - host.architecture
  - host.hostname
  - host.id
  - host.ip
  - host.mac
  - host.name
  - host.os.Ext.variant
  - host.os.family
  - host.os.full
  - host.os.kernel
  - host.os.name
  - host.os.platform
  - host.os.type
  - host.os.version
  - message
  - process.Ext.api.behaviors
  - process.Ext.api.metadata.target_address_name
  - process.Ext.api.metadata.target_address_path
  - process.Ext.api.name
  - process.Ext.api.parameters.address
  - process.Ext.api.parameters.allocation_type
  - process.Ext.api.parameters.argument1
  - process.Ext.api.parameters.argument2
  - process.Ext.api.parameters.argument3
  - process.Ext.api.parameters.context_flags
  - process.Ext.api.parameters.desired_access
  - process.Ext.api.parameters.desired_access_numeric
  - process.Ext.api.parameters.device
  - process.Ext.api.parameters.driver
  - process.Ext.api.parameters.eax
  - process.Ext.api.parameters.ebp
  - process.Ext.api.parameters.ebx
  - process.Ext.api.parameters.ecx
  - process.Ext.api.parameters.edi
  - process.Ext.api.parameters.edx
  - process.Ext.api.parameters.eip
  - process.Ext.api.parameters.esi
  - process.Ext.api.parameters.esp
  - process.Ext.api.parameters.handle_type
  - process.Ext.api.parameters.procedure
  - process.Ext.api.parameters.protection
  - process.Ext.api.parameters.protection_old
  - process.Ext.api.parameters.r8
  - process.Ext.api.parameters.r9
  - process.Ext.api.parameters.rax
  - process.Ext.api.parameters.rbp
  - process.Ext.api.parameters.rbx
  - process.Ext.api.parameters.rcx
  - process.Ext.api.parameters.rdi
  - process.Ext.api.parameters.rdx
  - process.Ext.api.parameters.rip
  - process.Ext.api.parameters.rsi
  - process.Ext.api.parameters.rsp
  - process.Ext.api.parameters.size
  - process.Ext.api.summary
  - process.Ext.code_signature.exists
  - process.Ext.code_signature.status
  - process.Ext.code_signature.subject_name
  - process.Ext.code_signature.thumbprint_sha256
  - process.Ext.code_signature.trusted
  - process.Ext.protection
  - process.Ext.token.integrity_level_name
  - process.code_signature.exists
  - process.code_signature.status
  - process.code_signature.subject_name
  - process.code_signature.thumbprint_sha256
  - process.code_signature.trusted
  - process.command_line
  - process.entity_id
  - process.executable
  - process.name
  - process.parent.executable
  - process.pid
  - process.thread.id
  - user.domain
  - user.id
  - user.name
