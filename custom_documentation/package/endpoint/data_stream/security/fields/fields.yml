definitions:
- name: authentication_login_successful
  values:
  - name: event.category
    value: authentication
  - name: event.category
    value: session
  - name: event.type
    value: start
  - name: event.outcome
    value: success
  - name: event.action
    value: log_on
  event.kind: event
  event.category: []
  event.type:
  - info
  os:
  - macos
- name: authentication_ssh_successful
  values:
  - name: event.category
    value: authentication
  - name: event.category
    value: session
  - name: event.type
    value: start
  - name: event.outcome
    value: success
  - name: event.action
    value: ssh_login
  event.kind: event
  event.category: []
  event.type:
  - info
  os:
  - macos
- name: authentication_rdp_successful
  values:
  - name: event.category
    value: authentication
  - name: event.category
    value: session
  - name: event.type
    value: start
  - name: event.outcome
    value: success
  - name: event.action
    value: rdp_login
  event.kind: event
  event.category: []
  event.type:
  - info
  os:
  - macos
- name: authentication_login_failure
  values:
  - name: event.category
    value: authentication
  - name: event.category
    value: session
  - name: event.type
    value: start
  - name: event.outcome
    value: failure
  - name: event.action
    value: log_on
  event.kind: event
  event.category: []
  event.type:
  - info
  os:
  - macos
- name: authentication_ssh_failure
  values:
  - name: event.category
    value: authentication
  - name: event.category
    value: session
  - name: event.type
    value: start
  - name: event.outcome
    value: failure
  - name: event.action
    value: ssh_login
  event.kind: event
  event.category: []
  event.type:
  - info
  os:
  - macos
- name: authentication_rdp_failure
  values:
  - name: event.category
    value: authentication
  - name: event.category
    value: session
  - name: event.type
    value: start
  - name: event.outcome
    value: failure
  - name: event.action
    value: rdp_login
  event.kind: event
  event.category: []
  event.type:
  - info
  os:
  - macos
- name: user_admin_logon
  event.kind: event
  event.category:
  - authentication
  - session
  event.type:
  - start
  event.outcome: success
  event.action: log_on
  os:
  - windows
- name: user_explicit_logon
  event.kind: event
  event.category:
  - authentication
  - session
  event.type:
  - start
  event.outcome: success
  event.action: log_on
  os:
  - windows
- name: user_logon
  event.kind: event
  event.category:
  - authentication
  - session
  event.type:
  - start
  event.outcome: success
  event.action: log_on
  os:
  - windows
- name: user_logon_failed
  event.kind: event
  event.category:
  - authentication
  - session
  event.type:
  - start
  event.outcome: failed
  event.action: log_on
  os:
  - windows
- name: user_logoff
  event.kind: event
  event.category:
  - authentication
  - session
  event.type:
  - end
  event.outcome: success
  event.action: log_off
  os:
  - windows
- name: workstation_locked
  event.kind: event
  event.category:
  - session
  event.type:
  - change
  event.action: workstation_locked
  os:
  - windows
- name: workstation_unlocked
  event.kind: event
  event.category:
  - session
  event.type:
  - change
  event.outcome: success
  event.action: workstation_unlocked
  os:
  - windows
os:
- windows
- macos
fields:
- ecs: '@timestamp'
  all:
  - all
- ecs: agent.id
  all:
  - all
- ecs: agent.type
  all:
  - all
- ecs: agent.version
  all:
  - all
- ecs: data_stream.dataset
  all:
  - all
- ecs: data_stream.namespace
  all:
  - all
- ecs: data_stream.type
  all:
  - all
- ecs: destination.geo.city_name
- ecs: destination.geo.continent_code
- ecs: destination.geo.continent_name
- ecs: destination.geo.country_iso_code
- ecs: destination.geo.country_name
- ecs: destination.geo.location
- ecs: destination.geo.name
- ecs: destination.geo.postal_code
- ecs: destination.geo.region_iso_code
- ecs: destination.geo.region_name
- ecs: destination.geo.timezone
- ecs: ecs.version
  windows:
  - user_admin_logon
  - user_explicit_logon
  - user_logon
  - user_logon_failed
  - user_admin_logoff
  - user_explicit_logoff
  - user_logoff
- ecs: event.action
  all:
  - all
- ecs: event.category
  all:
  - all
- ecs: event.code
- ecs: event.created
  all:
  - all
- ecs: event.dataset
  all:
  - all
- ecs: event.hash
- ecs: event.id
  all:
  - all
- ecs: event.ingested
  all:
  - all
- ecs: event.kind
  all:
  - all
- ecs: event.module
  all:
  - all
- ecs: event.outcome
  all:
  - all
- ecs: event.provider
- ecs: event.sequence
  all:
  - all
- ecs: event.severity
- ecs: event.type
  all:
  - all
- ecs: group.Ext
  macos:
  - authentication_login_successful
  - authentication_ssh_successful
  - authentication_rdp_successful
  - authentication_login_failure
  - authentication_ssh_failure
  - authentication_rdp_failure
- ecs: group.Ext.real
  macos:
  - authentication_login_successful
  - authentication_ssh_successful
  - authentication_rdp_successful
  - authentication_login_failure
  - authentication_ssh_failure
  - authentication_rdp_failure
- ecs: group.Ext.real.id
  macos:
  - authentication_login_successful
  - authentication_ssh_successful
  - authentication_rdp_successful
  - authentication_login_failure
  - authentication_ssh_failure
  - authentication_rdp_failure
- ecs: group.Ext.real.name
  macos:
  - authentication_login_successful
  - authentication_ssh_successful
  - authentication_rdp_successful
  - authentication_login_failure
  - authentication_ssh_failure
  - authentication_rdp_failure
- ecs: group.domain
  macos:
  - authentication_login_successful
  - authentication_ssh_successful
  - authentication_rdp_successful
  - authentication_login_failure
  - authentication_ssh_failure
  - authentication_rdp_failure
- ecs: group.id
  macos:
  - authentication_login_successful
  - authentication_ssh_successful
  - authentication_rdp_successful
  - authentication_login_failure
  - authentication_ssh_failure
  - authentication_rdp_failure
- ecs: group.name
  macos:
  - authentication_login_successful
  - authentication_ssh_successful
  - authentication_rdp_successful
  - authentication_login_failure
  - authentication_ssh_failure
  - authentication_rdp_failure
- ecs: host.architecture
  all:
  - all
- ecs: host.domain
- ecs: host.hostname
  all:
  - all
- ecs: host.id
  all:
  - all
- ecs: host.ip
  all:
  - all
- ecs: host.mac
  all:
  - all
- ecs: host.name
  all:
  - all
- ecs: host.os.Ext
- ecs: host.os.Ext.variant
  all:
  - all
- ecs: host.os.family
  all:
  - all
- ecs: host.os.full
  all:
  - all
- ecs: host.os.kernel
  all:
  - all
- ecs: host.os.name
  all:
  - all
- ecs: host.os.platform
  all:
  - all
- ecs: host.os.type
  all:
  - all
- ecs: host.os.version
  all:
  - all
- ecs: host.type
- ecs: host.uptime
- ecs: message
  all:
  - all
- ecs: process.Ext
- ecs: process.Ext.ancestry
  windows:
  - user_admin_logon
  - user_explicit_logon
  - user_logon
  - user_logon_failed
  - user_admin_logoff
  - user_explicit_logoff
  - user_logoff
- ecs: process.Ext.code_signature
  windows:
  - all
  - all
- ecs: process.Ext.code_signature.exists
- ecs: process.Ext.code_signature.status
- ecs: process.Ext.code_signature.subject_name
- ecs: process.Ext.code_signature.trusted
- ecs: process.Ext.code_signature.valid
- ecs: process.code_signature.exists
  windows:
  - user_admin_logon
  - user_explicit_logon
  - user_logon
  - user_logon_failed
  - user_admin_logoff
  - user_explicit_logoff
  - user_logoff
- ecs: process.code_signature.signing_id
- ecs: process.code_signature.status
  windows:
  - user_admin_logon
  - user_explicit_logon
  - user_logon
  - user_logon_failed
  - user_admin_logoff
  - user_explicit_logoff
  - user_logoff
- ecs: process.code_signature.subject_name
  windows:
  - user_admin_logon
  - user_explicit_logon
  - user_logon
  - user_logon_failed
  - user_admin_logoff
  - user_explicit_logoff
  - user_logoff
- ecs: process.code_signature.team_id
- ecs: process.code_signature.trusted
  windows:
  - user_admin_logon
  - user_explicit_logon
  - user_logon
  - user_logon_failed
  - user_admin_logoff
  - user_explicit_logoff
  - user_logoff
- ecs: process.code_signature.valid
- ecs: process.entity_id
  windows:
  - user_admin_logon
  - user_explicit_logon
  - user_logon
  - user_logon_failed
  - user_admin_logoff
  - user_explicit_logoff
  - user_logoff
- ecs: process.executable
  windows:
  - user_admin_logon
  - user_explicit_logon
  - user_logon
  - user_logon_failed
  - user_admin_logoff
  - user_explicit_logoff
  - user_logoff
- ecs: process.name
  windows:
  - user_admin_logon
  - user_explicit_logon
  - user_logon
  - user_logon_failed
- ecs: process.pid
- ecs: process.thread.id
- ecs: source.geo.city_name
- ecs: source.geo.continent_code
- ecs: source.geo.continent_name
- ecs: source.geo.country_iso_code
- ecs: source.geo.country_name
- ecs: source.geo.location
- ecs: source.geo.name
- ecs: source.geo.postal_code
- ecs: source.geo.region_iso_code
- ecs: source.geo.region_name
- ecs: source.geo.timezone
- ecs: user.Ext
- ecs: user.Ext.real
- ecs: user.Ext.real.id
- ecs: user.Ext.real.name
- ecs: user.domain
  windows:
  - user_admin_logon
  - user_explicit_logon
  - user_logon
  - user_logon_failed
  - user_admin_logoff
  - user_explicit_logoff
  - user_logoff
- ecs: user.email
- ecs: user.full_name
- ecs: user.group.Ext
- ecs: user.group.Ext.real
- ecs: user.group.Ext.real.id
- ecs: user.group.Ext.real.name
- ecs: user.group.domain
- ecs: user.group.id
- ecs: user.group.name
- ecs: user.hash
- ecs: user.id
  windows:
  - user_admin_logon
  - user_explicit_logon
  - user_logon
  - user_logon_failed
  - user_admin_logoff
  - user_explicit_logoff
  - user_logoff
- ecs: user.name
  windows:
  - user_admin_logon
  - user_explicit_logon
  - user_logon
  - user_logon_failed
  - user_admin_logoff
  - user_explicit_logoff
  - user_logoff
