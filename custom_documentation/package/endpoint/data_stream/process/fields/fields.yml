definitions:
- name: process_creation
  values:
  - name: event.type
    value: start
  - name: event.action
    value: start
  event.kind: event
  event.category: []
  event.type:
  - info
- name: process_fork
  values:
  - name: event.type
    value: start
  - name: event.action
    value: fork
  event.kind: event
  event.category: []
  event.type:
  - info
- name: process_uid_change
  values:
  - name: event.type
    value: change
  - name: event.action
    value: uid_change
  event.kind: event
  event.category: []
  event.type:
  - info
- name: process_gid_change
  values:
  - name: event.type
    value: change
  - name: event.action
    value: gid_change
  event.kind: event
  event.category: []
  event.type:
  - info
- name: process_session_id_change
  values:
  - name: event.type
    value: change
  - name: event.action
    value: session_id_change
  event.kind: event
  event.category: []
  event.type:
  - info
- name: process_exec
  values:
  - name: event.type
    value: start
  - name: event.action
    value: exec
  event.kind: event
  event.category: []
  event.type:
  - info
- name: process_already_running
  values:
  - name: event.type
    value: info
  event.kind: event
  event.category: []
  event.type:
  - info
- name: process_termination
  values:
  - name: event.type
    value: end
  - name: event.action
    value: end
  event.kind: event
  event.category: []
  event.type:
  - info
- name: process_remote_thread
  values:
  - name: event.type
    value: start
  - name: event.action
    value: remote_thread
  event.kind: event
  event.category: []
  event.type:
  - info
- name: process_get_task
  event.kind: event
  event.category: []
  event.type:
  - start
  event.action: process_open
- name: process_io
  values:
  - name: event.type
    value: info
  - name: event.action
    value: text_output
  event.kind: event
  event.category: []
  event.type:
  - info
- name: process_unshare
  event.kind: event
  event.category: []
  event.type:
  - info
os:
- linux
- macos
- windows
fields:
- ecs: '@timestamp'
  all:
  - all
- ecs: agent.ephemeral_id
- ecs: agent.id
  all:
  - all
- ecs: agent.name
- ecs: agent.type
  all:
  - all
- ecs: agent.version
  all:
  - all
- ecs: cloud.account.id
- ecs: cloud.instance.name
- ecs: cloud.project.id
- ecs: cloud.provider
- ecs: cloud.region
- ecs: container.id
- ecs: container.image.hash.all
- ecs: container.image.name
- ecs: container.image.tag
- ecs: container.name
- ecs: data_stream.dataset
  all:
  - all
- ecs: data_stream.namespace
  all:
  - all
- ecs: data_stream.type
  all:
  - all
- ecs: destination.geo.city_name
- ecs: destination.geo.continent_code
- ecs: destination.geo.continent_name
- ecs: destination.geo.country_iso_code
- ecs: destination.geo.country_name
- ecs: destination.geo.location
- ecs: destination.geo.name
- ecs: destination.geo.postal_code
- ecs: destination.geo.region_iso_code
- ecs: destination.geo.region_name
- ecs: destination.geo.timezone
- ecs: ecs.version
  all:
  - all
- ecs: event.action
  all:
  - all
- ecs: event.category
  all:
  - all
- ecs: event.code
- ecs: event.created
  all:
  - all
- ecs: event.dataset
  all:
  - all
- ecs: event.hash
- ecs: event.id
  all:
  - all
- ecs: event.ingested
  all:
  - all
- ecs: event.kind
  all:
  - all
- ecs: event.module
  all:
  - all
- ecs: event.outcome
- ecs: event.provider
- ecs: event.sequence
  all:
  - all
- ecs: event.severity
- ecs: event.type
  all:
  - all
- ecs: group.Ext
- ecs: group.Ext.real
- ecs: group.Ext.real.id
- ecs: group.Ext.real.name
- ecs: group.domain
- ecs: group.id
- ecs: group.name
- ecs: host.architecture
  all:
  - all
- ecs: host.boot.id
- ecs: host.domain
- ecs: host.hostname
  all:
  - all
- ecs: host.id
  all:
  - all
- ecs: host.ip
  all:
  - all
- ecs: host.mac
  all:
  - all
- ecs: host.name
  all:
  - all
- ecs: host.os.Ext
- ecs: host.os.Ext.variant
  all:
  - all
- ecs: host.os.family
  all:
  - all
- ecs: host.os.full
  all:
  - all
- ecs: host.os.kernel
  all:
  - all
- ecs: host.os.name
  all:
  - all
- ecs: host.os.platform
  all:
  - all
- ecs: host.os.type
  all:
  - all
- ecs: host.os.version
  all:
  - all
- ecs: host.pid_ns_ino
- ecs: host.type
- ecs: host.uptime
- ecs: message
  all:
  - all
- ecs: orchestrator.cluster.id
- ecs: orchestrator.cluster.name
- ecs: orchestrator.namespace
- ecs: orchestrator.resource.ip
- ecs: orchestrator.resource.name
- ecs: orchestrator.resource.parent.type
- ecs: orchestrator.resource.type
- ecs: package.name
- ecs: process.Ext
- ecs: process.Ext.ancestry
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.Ext.architecture
- ecs: process.Ext.authentication_id
  windows:
  - process_creation
  - process_already_running
- ecs: process.Ext.code_signature
- ecs: process.Ext.code_signature.exists
- ecs: process.Ext.code_signature.status
- ecs: process.Ext.code_signature.subject_name
- ecs: process.Ext.code_signature.trusted
- ecs: process.Ext.code_signature.valid
- ecs: process.Ext.defense_evasions
  windows:
  - process_creation
  - process_already_running
- ecs: process.Ext.device.bus_type
- ecs: process.Ext.device.dos_name
- ecs: process.Ext.device.file_system_type
- ecs: process.Ext.device.nt_name
- ecs: process.Ext.device.product_id
- ecs: process.Ext.device.serial_number
- ecs: process.Ext.device.vendor_id
- ecs: process.Ext.device.volume_device_type
- ecs: process.Ext.dll.Ext
- ecs: process.Ext.dll.Ext.mapped_address
- ecs: process.Ext.dll.Ext.mapped_size
- ecs: process.Ext.dll.name
- ecs: process.Ext.dll.path
- ecs: process.Ext.effective_parent.entity_id
  windows:
  - process_creation
- ecs: process.Ext.effective_parent.executable
  windows:
  - process_creation
- ecs: process.Ext.effective_parent.name
  windows:
  - process_creation
- ecs: process.Ext.effective_parent.pid
  windows:
  - process_creation
- ecs: process.Ext.mitigation_policies
- ecs: process.Ext.protection
  windows:
  - process_creation
  - process_already_running
- ecs: process.Ext.relative_file_creation_time
  windows:
  - process_creation
  - process_already_running
- ecs: process.Ext.relative_file_name_modify_time
  windows:
  - process_creation
- ecs: process.Ext.session
- ecs: process.Ext.session_info.authentication_package
  windows:
  - process_termination
  - process_already_running
  - process_creation
- ecs: process.Ext.session_info.client_address
- ecs: process.Ext.session_info.id
  windows:
  - process_already_running
  - process_creation
- ecs: process.Ext.session_info.logon_type
  windows:
  - process_termination
  - process_already_running
  - process_creation
- ecs: process.Ext.session_info.relative_logon_time
  windows:
  - process_termination
  - process_already_running
  - process_creation
- ecs: process.Ext.session_info.relative_password_age
  windows:
  - process_termination
  - process_already_running
  - process_creation
- ecs: process.Ext.session_info.user_flags
  windows:
  - process_termination
  - process_already_running
  - process_creation
- ecs: process.Ext.token.elevation
- ecs: process.Ext.token.elevation_level
  windows:
  - process_creation
  - process_already_running
- ecs: process.Ext.token.elevation_type
- ecs: process.Ext.token.integrity_level_name
  windows:
  - process_creation
  - process_already_running
- ecs: process.Ext.token.security_attributes
  windows:
  - process_creation
  - process_already_running
- ecs: process.Ext.trusted
  windows:
  - process_termination
  - process_already_running
- ecs: process.Ext.trusted_descendant
- ecs: process.args
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.args_count
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.code_signature.exists
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.code_signature.signing_id
- ecs: process.code_signature.status
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.code_signature.subject_name
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.code_signature.team_id
- ecs: process.code_signature.trusted
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.code_signature.valid
- ecs: process.command_line
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.end
- ecs: process.entity_id
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.entry_leader.args
- ecs: process.entry_leader.args_count
- ecs: process.entry_leader.attested_groups.name
- ecs: process.entry_leader.attested_user.id
- ecs: process.entry_leader.attested_user.name
- ecs: process.entry_leader.command_line
- ecs: process.entry_leader.entity_id
- ecs: process.entry_leader.entry_meta.source.ip
- ecs: process.entry_leader.entry_meta.type
- ecs: process.entry_leader.executable
- ecs: process.entry_leader.group.id
- ecs: process.entry_leader.group.name
- ecs: process.entry_leader.interactive
- ecs: process.entry_leader.name
- ecs: process.entry_leader.parent.entity_id
- ecs: process.entry_leader.parent.pid
- ecs: process.entry_leader.parent.session_leader.entity_id
- ecs: process.entry_leader.parent.session_leader.pid
- ecs: process.entry_leader.parent.session_leader.start
- ecs: process.entry_leader.parent.start
- ecs: process.entry_leader.pid
- ecs: process.entry_leader.real_group.id
- ecs: process.entry_leader.real_group.name
- ecs: process.entry_leader.real_user.id
- ecs: process.entry_leader.real_user.name
- ecs: process.entry_leader.same_as_process
- ecs: process.entry_leader.saved_group.id
- ecs: process.entry_leader.saved_group.name
- ecs: process.entry_leader.saved_user.id
- ecs: process.entry_leader.saved_user.name
- ecs: process.entry_leader.start
- ecs: process.entry_leader.supplemental_groups.id
- ecs: process.entry_leader.supplemental_groups.name
- ecs: process.entry_leader.tty
- ecs: process.entry_leader.tty.char_device.major
- ecs: process.entry_leader.tty.char_device.minor
- ecs: process.entry_leader.user.id
- ecs: process.entry_leader.user.name
- ecs: process.entry_leader.working_directory
- ecs: process.env_vars
- ecs: process.executable
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.exit_code
  windows:
  - process_termination
- ecs: process.group.id
- ecs: process.group.name
- ecs: process.group_leader.args
- ecs: process.group_leader.args_count
- ecs: process.group_leader.command_line
- ecs: process.group_leader.entity_id
- ecs: process.group_leader.executable
- ecs: process.group_leader.group.id
- ecs: process.group_leader.group.name
- ecs: process.group_leader.interactive
- ecs: process.group_leader.name
- ecs: process.group_leader.pid
- ecs: process.group_leader.real_group.id
- ecs: process.group_leader.real_group.name
- ecs: process.group_leader.real_user.id
- ecs: process.group_leader.real_user.name
- ecs: process.group_leader.same_as_process
- ecs: process.group_leader.saved_group.id
- ecs: process.group_leader.saved_group.name
- ecs: process.group_leader.saved_user.id
- ecs: process.group_leader.saved_user.name
- ecs: process.group_leader.start
- ecs: process.group_leader.supplemental_groups.id
- ecs: process.group_leader.supplemental_groups.name
- ecs: process.group_leader.tty
- ecs: process.group_leader.tty.char_device.major
- ecs: process.group_leader.tty.char_device.minor
- ecs: process.group_leader.user.id
- ecs: process.group_leader.user.name
- ecs: process.group_leader.working_directory
- ecs: process.hash.md5
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.hash.sha1
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.hash.sha256
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.hash.sha512
- ecs: process.interactive
- ecs: process.io
- ecs: process.io.max_bytes_per_process_exceeded
- ecs: process.io.text
- ecs: process.io.total_bytes_captured
- ecs: process.io.total_bytes_skipped
- ecs: process.name
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.parent.Ext
- ecs: process.parent.Ext.architecture
- ecs: process.parent.Ext.code_signature
- ecs: process.parent.Ext.code_signature.exists
- ecs: process.parent.Ext.code_signature.status
- ecs: process.parent.Ext.code_signature.subject_name
- ecs: process.parent.Ext.code_signature.trusted
- ecs: process.parent.Ext.code_signature.valid
- ecs: process.parent.Ext.protection
- ecs: process.parent.Ext.real
- ecs: process.parent.Ext.real.pid
  windows:
  - process_creation
- ecs: process.parent.Ext.user
- ecs: process.parent.args
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.parent.args_count
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.parent.code_signature.exists
- ecs: process.parent.code_signature.signing_id
- ecs: process.parent.code_signature.status
- ecs: process.parent.code_signature.subject_name
- ecs: process.parent.code_signature.team_id
- ecs: process.parent.code_signature.trusted
- ecs: process.parent.code_signature.valid
- ecs: process.parent.command_line
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.parent.entity_id
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.parent.executable
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.parent.exit_code
- ecs: process.parent.group.id
- ecs: process.parent.group.name
- ecs: process.parent.group_leader.entity_id
- ecs: process.parent.group_leader.pid
- ecs: process.parent.group_leader.start
- ecs: process.parent.hash.md5
- ecs: process.parent.hash.sha1
- ecs: process.parent.hash.sha256
- ecs: process.parent.hash.sha512
- ecs: process.parent.interactive
- ecs: process.parent.name
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.parent.pe.company
- ecs: process.parent.pe.description
- ecs: process.parent.pe.file_version
- ecs: process.parent.pe.imphash
- ecs: process.parent.pe.original_file_name
- ecs: process.parent.pe.product
- ecs: process.parent.pgid
- ecs: process.parent.pid
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.parent.ppid
- ecs: process.parent.real_group.id
- ecs: process.parent.real_group.name
- ecs: process.parent.real_user.id
- ecs: process.parent.real_user.name
- ecs: process.parent.saved_group.id
- ecs: process.parent.saved_group.name
- ecs: process.parent.saved_user.id
- ecs: process.parent.saved_user.name
- ecs: process.parent.start
- ecs: process.parent.supplemental_groups.id
- ecs: process.parent.supplemental_groups.name
- ecs: process.parent.thread.Ext
- ecs: process.parent.thread.Ext.call_stack
- ecs: process.parent.thread.Ext.call_stack.allocation_private_bytes
- ecs: process.parent.thread.Ext.call_stack.callsite_leading_bytes
- ecs: process.parent.thread.Ext.call_stack.callsite_trailing_bytes
- ecs: process.parent.thread.Ext.call_stack.protection
- ecs: process.parent.thread.Ext.call_stack.symbol_info
- ecs: process.parent.thread.Ext.call_stack_contains_unbacked
  windows:
  - process_termination
  - process_creation
- ecs: process.parent.thread.Ext.call_stack_summary
- ecs: process.parent.thread.id
- ecs: process.parent.thread.name
- ecs: process.parent.title
- ecs: process.parent.tty
- ecs: process.parent.tty.char_device.major
- ecs: process.parent.tty.char_device.minor
- ecs: process.parent.uptime
- ecs: process.parent.user.id
- ecs: process.parent.user.name
- ecs: process.parent.working_directory
- ecs: process.pe.company
- ecs: process.pe.description
- ecs: process.pe.file_version
- ecs: process.pe.imphash
  windows:
  - process_termination
  - process_already_running
  - process_creation
- ecs: process.pe.original_file_name
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.pe.product
- ecs: process.pgid
- ecs: process.pid
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: process.ppid
- ecs: process.previous.args
- ecs: process.previous.args_count
- ecs: process.previous.executable
- ecs: process.real_group.id
- ecs: process.real_group.name
- ecs: process.real_user.id
- ecs: process.real_user.name
- ecs: process.saved_group.id
- ecs: process.saved_group.name
- ecs: process.saved_user.id
- ecs: process.saved_user.name
- ecs: process.session_leader.args
- ecs: process.session_leader.args_count
- ecs: process.session_leader.command_line
- ecs: process.session_leader.entity_id
- ecs: process.session_leader.executable
- ecs: process.session_leader.group.id
- ecs: process.session_leader.group.name
- ecs: process.session_leader.interactive
- ecs: process.session_leader.name
- ecs: process.session_leader.parent.entity_id
- ecs: process.session_leader.parent.pid
- ecs: process.session_leader.parent.session_leader.entity_id
- ecs: process.session_leader.parent.session_leader.pid
- ecs: process.session_leader.parent.session_leader.start
- ecs: process.session_leader.parent.start
- ecs: process.session_leader.pid
- ecs: process.session_leader.real_group.id
- ecs: process.session_leader.real_group.name
- ecs: process.session_leader.real_user.id
- ecs: process.session_leader.real_user.name
- ecs: process.session_leader.same_as_process
- ecs: process.session_leader.saved_group.id
- ecs: process.session_leader.saved_group.name
- ecs: process.session_leader.saved_user.id
- ecs: process.session_leader.saved_user.name
- ecs: process.session_leader.start
- ecs: process.session_leader.supplemental_groups.id
- ecs: process.session_leader.supplemental_groups.name
- ecs: process.session_leader.tty
- ecs: process.session_leader.tty.char_device.major
- ecs: process.session_leader.tty.char_device.minor
- ecs: process.session_leader.user.id
- ecs: process.session_leader.user.name
- ecs: process.session_leader.working_directory
- ecs: process.start
- ecs: process.supplemental_groups.id
- ecs: process.supplemental_groups.name
- ecs: process.thread.id
- ecs: process.thread.name
- ecs: process.title
- ecs: process.tty
- ecs: process.tty.char_device.major
- ecs: process.tty.char_device.minor
- ecs: process.tty.columns
- ecs: process.tty.rows
- ecs: process.uptime
- ecs: process.user.id
- ecs: process.user.name
- ecs: process.working_directory
  windows:
  - process_creation
  - process_already_running
- ecs: source.geo.city_name
- ecs: source.geo.continent_code
- ecs: source.geo.continent_name
- ecs: source.geo.country_iso_code
- ecs: source.geo.country_name
- ecs: source.geo.location
- ecs: source.geo.name
- ecs: source.geo.postal_code
- ecs: source.geo.region_iso_code
- ecs: source.geo.region_name
- ecs: source.geo.timezone
- ecs: user.Ext
- ecs: user.Ext.real
- ecs: user.Ext.real.id
- ecs: user.Ext.real.name
- ecs: user.domain
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: user.email
- ecs: user.full_name
- ecs: user.group.Ext
- ecs: user.group.Ext.real
- ecs: user.group.Ext.real.id
- ecs: user.group.Ext.real.name
- ecs: user.group.domain
- ecs: user.group.id
- ecs: user.group.name
- ecs: user.hash
- ecs: user.id
  windows:
  - process_creation
  - process_termination
  - process_already_running
- ecs: user.name
  windows:
  - process_creation
  - process_termination
  - process_already_running
