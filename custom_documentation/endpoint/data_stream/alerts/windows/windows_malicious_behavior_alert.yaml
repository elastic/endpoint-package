overview:
  description: FILL ME IN
  name: Windows Malicious Behavior Alert
identification:
  filter:
    event.code: behavior
    event.dataset: endpoint.alerts
    event.module: endpoint
    host.os.type: windows
fields:
  endpoint:
  - '@timestamp'
  - Endpoint.policy.applied.artifacts.global.identifiers.name
  - Endpoint.policy.applied.artifacts.global.identifiers.sha256
  - Endpoint.policy.applied.artifacts.global.version
  - Endpoint.policy.applied.artifacts.user.identifiers.name
  - Endpoint.policy.applied.artifacts.user.identifiers.sha256
  - Endpoint.policy.applied.artifacts.user.version
  - Events.@timestamp
  - Events.Target.process.Ext.memory_region.allocation_base
  - Events.Target.process.Ext.memory_region.allocation_protection
  - Events.Target.process.Ext.memory_region.allocation_size
  - Events.Target.process.Ext.memory_region.allocation_type
  - Events.Target.process.Ext.memory_region.bytes_allocation_offset
  - Events.Target.process.Ext.memory_region.hash.sha256
  - Events.Target.process.Ext.memory_region.memory_pe_detected
  - Events.Target.process.Ext.memory_region.region_base
  - Events.Target.process.Ext.memory_region.region_protection
  - Events.Target.process.Ext.memory_region.region_size
  - Events.Target.process.Ext.memory_region.region_state
  - Events.Target.process.Ext.memory_region.strings
  - Events.Target.process.name
  - Events.Target.process.pid
  - Events._label
  - Events._state
  - Events.dll.Ext.code_signature.exists
  - Events.dll.Ext.code_signature.status
  - Events.dll.Ext.code_signature.subject_name
  - Events.dll.Ext.code_signature.trusted
  - Events.dll.Ext.load_index
  - Events.dll.Ext.size
  - Events.dll.code_signature.exists
  - Events.dll.code_signature.status
  - Events.dll.code_signature.subject_name
  - Events.dll.code_signature.trusted
  - Events.dll.hash.md5
  - Events.dll.hash.sha1
  - Events.dll.hash.sha256
  - Events.dll.name
  - Events.dll.path
  - Events.dll.pe.file_version
  - Events.dll.pe.imphash
  - Events.dll.pe.original_file_name
  - Events.event.action
  - Events.event.category
  - Events.event.created
  - Events.event.id
  - Events.event.kind
  - Events.event.outcome
  - Events.event.provider
  - Events.event.type
  - Events.file.Ext.entropy
  - Events.file.Ext.header_bytes
  - Events.file.Ext.monotonic_id
  - Events.file.Ext.windows.zone_identifier
  - Events.file.extension
  - Events.file.name
  - Events.file.path
  - Events.file.size
  - Events.host.architecture
  - Events.host.hostname
  - Events.host.id
  - Events.host.ip
  - Events.host.mac
  - Events.host.name
  - Events.host.os.Ext.variant
  - Events.host.os.family
  - Events.host.os.full
  - Events.host.os.kernel
  - Events.host.os.name
  - Events.host.os.platform
  - Events.host.os.type
  - Events.host.os.version
  - Events.message
  - Events.process.Ext.ancestry
  - Events.process.Ext.api.behaviors
  - Events.process.Ext.api.name
  - Events.process.Ext.api.parameters.address
  - Events.process.Ext.api.parameters.desired_access
  - Events.process.Ext.api.parameters.desired_access_numeric
  - Events.process.Ext.api.parameters.handle_type
  - Events.process.Ext.api.parameters.size
  - Events.process.Ext.api.summary
  - Events.process.Ext.authentication_id
  - Events.process.Ext.code_signature.exists
  - Events.process.Ext.code_signature.status
  - Events.process.Ext.code_signature.subject_name
  - Events.process.Ext.code_signature.trusted
  - Events.process.Ext.memory_region.allocation_base
  - Events.process.Ext.memory_region.allocation_protection
  - Events.process.Ext.memory_region.allocation_size
  - Events.process.Ext.memory_region.allocation_type
  - Events.process.Ext.memory_region.mapped_path
  - Events.process.Ext.memory_region.region_base
  - Events.process.Ext.memory_region.region_protection
  - Events.process.Ext.memory_region.region_size
  - Events.process.Ext.memory_region.region_state
  - Events.process.Ext.mitigation_policies
  - Events.process.Ext.relative_file_creation_time
  - Events.process.Ext.relative_file_name_modify_time
  - Events.process.Ext.session_info.authentication_package
  - Events.process.Ext.session_info.id
  - Events.process.Ext.session_info.logon_type
  - Events.process.Ext.session_info.relative_logon_time
  - Events.process.Ext.session_info.relative_password_age
  - Events.process.Ext.session_info.user_flags
  - Events.process.Ext.token.elevation_level
  - Events.process.Ext.token.integrity_level_name
  - Events.process.Ext.token.security_attributes
  - Events.process.args
  - Events.process.args_count
  - Events.process.code_signature.exists
  - Events.process.code_signature.status
  - Events.process.code_signature.subject_name
  - Events.process.code_signature.trusted
  - Events.process.command_line
  - Events.process.entity_id
  - Events.process.executable
  - Events.process.hash.md5
  - Events.process.hash.sha1
  - Events.process.hash.sha256
  - Events.process.name
  - Events.process.parent.Ext.code_signature.exists
  - Events.process.parent.Ext.code_signature.status
  - Events.process.parent.Ext.code_signature.subject_name
  - Events.process.parent.Ext.code_signature.trusted
  - Events.process.parent.args
  - Events.process.parent.args_count
  - Events.process.parent.code_signature.exists
  - Events.process.parent.code_signature.status
  - Events.process.parent.code_signature.subject_name
  - Events.process.parent.code_signature.trusted
  - Events.process.parent.command_line
  - Events.process.parent.entity_id
  - Events.process.parent.executable
  - Events.process.parent.name
  - Events.process.parent.pid
  - Events.process.parent.thread.Ext.call_stack.allocation_private_bytes
  - Events.process.parent.thread.Ext.call_stack.callsite_leading_bytes
  - Events.process.parent.thread.Ext.call_stack.callsite_trailing_bytes
  - Events.process.parent.thread.Ext.call_stack.protection
  - Events.process.parent.thread.Ext.call_stack.symbol_info
  - Events.process.parent.thread.Ext.call_stack_contains_unbacked
  - Events.process.parent.thread.Ext.call_stack_summary
  - Events.process.pe.imphash
  - Events.process.pe.original_file_name
  - Events.process.pid
  - Events.process.thread.Ext.call_stack.callsite_leading_bytes
  - Events.process.thread.Ext.call_stack.callsite_trailing_bytes
  - Events.process.thread.Ext.call_stack.instruction_pointer
  - Events.process.thread.Ext.call_stack.module_path
  - Events.process.thread.Ext.call_stack.protection
  - Events.process.thread.Ext.call_stack.symbol_info
  - Events.process.thread.Ext.call_stack_contains_unbacked
  - Events.process.thread.Ext.call_stack_final_user_module.path
  - Events.process.thread.Ext.call_stack_summary
  - Events.process.thread.id
  - Events.process.uptime
  - Events.process.working_directory
  - Events.registry.data.strings
  - Events.registry.data.type
  - Events.registry.hive
  - Events.registry.key
  - Events.registry.path
  - Events.registry.value
  - Events.user.domain
  - Events.user.id
  - Events.user.name
  - Responses.@timestamp
  - Responses.action.action
  - Responses.action.field
  - Responses.action.file.attributes
  - Responses.action.file.path
  - Responses.action.file.reason
  - Responses.action.key.actions
  - Responses.action.key.path
  - Responses.action.key.values.actions
  - Responses.action.key.values.name
  - Responses.action.source.attributes
  - Responses.action.source.path
  - Responses.action.state
  - Responses.action.tree
  - Responses.message
  - Responses.process.entity_id
  - Responses.process.name
  - Responses.process.pid
  - Responses.result
  - Target.process.Ext.memory_region.allocation_base
  - Target.process.Ext.memory_region.allocation_protection
  - Target.process.Ext.memory_region.allocation_size
  - Target.process.Ext.memory_region.allocation_type
  - Target.process.Ext.memory_region.bytes_allocation_offset
  - Target.process.Ext.memory_region.hash.sha256
  - Target.process.Ext.memory_region.memory_pe_detected
  - Target.process.Ext.memory_region.region_base
  - Target.process.Ext.memory_region.region_protection
  - Target.process.Ext.memory_region.region_size
  - Target.process.Ext.memory_region.region_state
  - Target.process.Ext.memory_region.strings
  - Target.process.name
  - Target.process.pid
  - agent.build.original
  - agent.id
  - agent.type
  - agent.version
  - data_stream.dataset
  - data_stream.namespace
  - data_stream.type
  - dll.Ext.code_signature.exists
  - dll.Ext.code_signature.status
  - dll.Ext.code_signature.subject_name
  - dll.Ext.code_signature.trusted
  - dll.Ext.load_index
  - dll.Ext.size
  - dll.code_signature.exists
  - dll.code_signature.status
  - dll.code_signature.subject_name
  - dll.code_signature.trusted
  - dll.hash.md5
  - dll.hash.sha1
  - dll.hash.sha256
  - dll.name
  - dll.path
  - dll.pe.file_version
  - dll.pe.imphash
  - dll.pe.original_file_name
  - ecs.version
  - elastic.agent.id
  - event.action
  - event.category
  - event.code
  - event.created
  - event.dataset
  - event.id
  - event.kind
  - event.module
  - event.outcome
  - event.risk_score
  - event.sequence
  - event.severity
  - event.type
  - file.Ext.entropy
  - file.Ext.header_bytes
  - file.Ext.monotonic_id
  - file.Ext.windows.zone_identifier
  - file.extension
  - file.name
  - file.path
  - file.size
  - host.architecture
  - host.hostname
  - host.id
  - host.ip
  - host.mac
  - host.name
  - host.os.Ext.variant
  - host.os.family
  - host.os.full
  - host.os.kernel
  - host.os.name
  - host.os.platform
  - host.os.type
  - host.os.version
  - message
  - process.Ext.ancestry
  - process.Ext.api.behaviors
  - process.Ext.api.name
  - process.Ext.api.parameters.address
  - process.Ext.api.parameters.desired_access
  - process.Ext.api.parameters.desired_access_numeric
  - process.Ext.api.parameters.handle_type
  - process.Ext.api.parameters.size
  - process.Ext.api.summary
  - process.Ext.authentication_id
  - process.Ext.code_signature.exists
  - process.Ext.code_signature.status
  - process.Ext.code_signature.subject_name
  - process.Ext.code_signature.trusted
  - process.Ext.memory_region.allocation_base
  - process.Ext.memory_region.allocation_protection
  - process.Ext.memory_region.allocation_size
  - process.Ext.memory_region.allocation_type
  - process.Ext.memory_region.mapped_path
  - process.Ext.memory_region.region_base
  - process.Ext.memory_region.region_protection
  - process.Ext.memory_region.region_size
  - process.Ext.memory_region.region_state
  - process.Ext.mitigation_policies
  - process.Ext.relative_file_creation_time
  - process.Ext.relative_file_name_modify_time
  - process.Ext.session_info.authentication_package
  - process.Ext.session_info.id
  - process.Ext.session_info.logon_type
  - process.Ext.session_info.relative_logon_time
  - process.Ext.session_info.relative_password_age
  - process.Ext.session_info.user_flags
  - process.Ext.token.elevation_level
  - process.Ext.token.integrity_level_name
  - process.Ext.token.security_attributes
  - process.args
  - process.args_count
  - process.code_signature.exists
  - process.code_signature.status
  - process.code_signature.subject_name
  - process.code_signature.trusted
  - process.command_line
  - process.entity_id
  - process.executable
  - process.hash.md5
  - process.hash.sha1
  - process.hash.sha256
  - process.name
  - process.parent.Ext.code_signature.exists
  - process.parent.Ext.code_signature.status
  - process.parent.Ext.code_signature.subject_name
  - process.parent.Ext.code_signature.trusted
  - process.parent.args
  - process.parent.args_count
  - process.parent.code_signature.exists
  - process.parent.code_signature.status
  - process.parent.code_signature.subject_name
  - process.parent.code_signature.trusted
  - process.parent.command_line
  - process.parent.entity_id
  - process.parent.executable
  - process.parent.name
  - process.parent.pid
  - process.parent.thread.Ext.call_stack.allocation_private_bytes
  - process.parent.thread.Ext.call_stack.callsite_leading_bytes
  - process.parent.thread.Ext.call_stack.callsite_trailing_bytes
  - process.parent.thread.Ext.call_stack.protection
  - process.parent.thread.Ext.call_stack.symbol_info
  - process.parent.thread.Ext.call_stack_contains_unbacked
  - process.parent.thread.Ext.call_stack_summary
  - process.pe.imphash
  - process.pe.original_file_name
  - process.pid
  - process.thread.Ext.call_stack.callsite_leading_bytes
  - process.thread.Ext.call_stack.callsite_trailing_bytes
  - process.thread.Ext.call_stack.instruction_pointer
  - process.thread.Ext.call_stack.module_path
  - process.thread.Ext.call_stack.protection
  - process.thread.Ext.call_stack.symbol_info
  - process.thread.Ext.call_stack_contains_unbacked
  - process.thread.Ext.call_stack_final_user_module.path
  - process.thread.Ext.call_stack_summary
  - process.thread.id
  - process.uptime
  - process.working_directory
  - registry.data.strings
  - registry.data.type
  - registry.hive
  - registry.key
  - registry.path
  - registry.value
  - rule.description
  - rule.id
  - rule.name
  - rule.reference
  - rule.ruleset
  - rule.version
  - threat.framework
  - threat.tactic.id
  - threat.tactic.name
  - threat.tactic.reference
  - threat.technique.id
  - threat.technique.name
  - threat.technique.reference
  - threat.technique.subtechnique.id
  - threat.technique.subtechnique.name
  - threat.technique.subtechnique.reference
  - user.domain
  - user.id
  - user.name
