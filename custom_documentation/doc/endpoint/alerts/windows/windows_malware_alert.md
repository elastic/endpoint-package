# Windows Malware Alert

- OS: Windows
- Data Stream: `logs-endpoint.alerts-*`
- KQL: `event.code : "malicious_file" and event.dataset : "endpoint.alerts" and event.module : "endpoint" and host.os.type : "windows"`

This alert is generated when a Malware alert occurs.


| Field |
|---|
| @timestamp |
| Endpoint.policy.applied.artifacts.global.identifiers.name |
| Endpoint.policy.applied.artifacts.global.identifiers.sha256 |
| Endpoint.policy.applied.artifacts.global.snapshot |
| Endpoint.policy.applied.artifacts.global.update_age |
| Endpoint.policy.applied.artifacts.global.version |
| Endpoint.policy.applied.artifacts.user.identifiers.name |
| Endpoint.policy.applied.artifacts.user.identifiers.sha256 |
| Endpoint.policy.applied.artifacts.user.version |
| Responses.@timestamp |
| Responses.action.action |
| Responses.action.file.attributes |
| Responses.action.file.path |
| Responses.action.file.reason |
| Responses.action.key.actions |
| Responses.action.key.path |
| Responses.action.key.values.actions |
| Responses.action.key.values.name |
| Responses.action.process.path |
| Responses.action.source.attributes |
| Responses.action.source.path |
| Responses.message |
| Responses.result |
| agent.build.original |
| agent.id |
| agent.type |
| agent.version |
| data_stream.dataset |
| data_stream.namespace |
| data_stream.type |
| ecs.version |
| elastic.agent.id |
| event.action |
| event.category |
| event.code |
| event.created |
| event.dataset |
| event.id |
| event.kind |
| event.module |
| event.outcome |
| event.risk_score |
| event.sequence |
| event.severity |
| event.type |
| file.Ext.code_signature.exists |
| file.Ext.code_signature.status |
| file.Ext.code_signature.subject_name |
| file.Ext.code_signature.trusted |
| file.Ext.device.bus_type |
| file.Ext.device.dos_name |
| file.Ext.device.file_system_type |
| file.Ext.device.nt_name |
| file.Ext.device.product_id |
| file.Ext.device.vendor_id |
| file.Ext.device.volume_device_type |
| file.Ext.malware_classification.identifier |
| file.Ext.malware_classification.score |
| file.Ext.malware_classification.threshold |
| file.Ext.malware_classification.version |
| file.Ext.malware_signature.all_names |
| file.Ext.malware_signature.identifier |
| file.Ext.malware_signature.primary.matches |
| file.Ext.malware_signature.primary.signature.hash.sha256 |
| file.Ext.malware_signature.primary.signature.id |
| file.Ext.malware_signature.primary.signature.name |
| file.Ext.malware_signature.version |
| file.Ext.quarantine_message |
| file.Ext.quarantine_path |
| file.Ext.quarantine_result |
| file.Ext.temp_file_path |
| file.accessed |
| file.code_signature.exists |
| file.code_signature.status |
| file.code_signature.subject_name |
| file.code_signature.trusted |
| file.created |
| file.directory |
| file.drive_letter |
| file.extension |
| file.hash.md5 |
| file.hash.sha1 |
| file.hash.sha256 |
| file.mtime |
| file.name |
| file.owner |
| file.path |
| file.pe.Ext.dotnet |
| file.pe.Ext.sections.hash.md5 |
| file.pe.Ext.sections.hash.sha256 |
| file.pe.Ext.sections.name |
| file.pe.Ext.streams.hash.md5 |
| file.pe.Ext.streams.hash.sha256 |
| file.pe.Ext.streams.name |
| file.pe.company |
| file.pe.description |
| file.pe.file_version |
| file.pe.original_file_name |
| file.pe.product |
| file.size |
| host.architecture |
| host.hostname |
| host.id |
| host.ip |
| host.mac |
| host.name |
| host.os.Ext.variant |
| host.os.family |
| host.os.full |
| host.os.kernel |
| host.os.name |
| host.os.platform |
| host.os.type |
| host.os.version |
| message |
| process.Ext.ancestry |
| process.Ext.architecture |
| process.Ext.code_signature.exists |
| process.Ext.code_signature.status |
| process.Ext.code_signature.subject_name |
| process.Ext.code_signature.trusted |
| process.Ext.protection |
| process.Ext.token.domain |
| process.Ext.token.elevation |
| process.Ext.token.elevation_type |
| process.Ext.token.integrity_level_name |
| process.Ext.token.sid |
| process.Ext.token.user |
| process.Ext.user |
| process.args |
| process.args_count |
| process.code_signature.exists |
| process.code_signature.status |
| process.code_signature.subject_name |
| process.code_signature.trusted |
| process.command_line |
| process.entity_id |
| process.executable |
| process.hash.md5 |
| process.hash.sha1 |
| process.hash.sha256 |
| process.name |
| process.parent.Ext.architecture |
| process.parent.Ext.code_signature.exists |
| process.parent.Ext.code_signature.status |
| process.parent.Ext.code_signature.subject_name |
| process.parent.Ext.code_signature.trusted |
| process.parent.Ext.protection |
| process.parent.Ext.user |
| process.parent.args |
| process.parent.args_count |
| process.parent.code_signature.exists |
| process.parent.code_signature.status |
| process.parent.code_signature.subject_name |
| process.parent.code_signature.trusted |
| process.parent.command_line |
| process.parent.entity_id |
| process.parent.executable |
| process.parent.hash.md5 |
| process.parent.hash.sha1 |
| process.parent.hash.sha256 |
| process.parent.name |
| process.parent.pid |
| process.parent.ppid |
| process.parent.start |
| process.parent.uptime |
| process.pe.company |
| process.pe.description |
| process.pe.file_version |
| process.pe.original_file_name |
| process.pe.product |
| process.pid |
| process.start |
| process.uptime |
| rule.id |
| rule.name |
| rule.ruleset |
| user.domain |
| user.name |

